<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>MongoDB &#8211; Stepan Suvorov Blog</title>
	<atom:link href="https://stepansuvorov.com/blog/tag/mongodb/feed/" rel="self" type="application/rss+xml" />
	<link>https://stepansuvorov.com/blog</link>
	<description>Release 2.0</description>
	<lastBuildDate>Sun, 22 Jan 2017 08:52:46 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=6.3.1</generator>
	<item>
		<title>oyao.ru &#8211; О Я Ору!</title>
		<link>https://stepansuvorov.com/blog/2015/03/oyao-ru-%d0%be-%d1%8f-%d0%be%d1%80%d1%83/</link>
					<comments>https://stepansuvorov.com/blog/2015/03/oyao-ru-%d0%be-%d1%8f-%d0%be%d1%80%d1%83/#respond</comments>
		
		<dc:creator><![CDATA[Stepan]]></dc:creator>
		<pubDate>Wed, 04 Mar 2015 19:43:37 +0000</pubDate>
				<category><![CDATA[Uncategorized]]></category>
		<category><![CDATA[heroku]]></category>
		<category><![CDATA[MongoDB]]></category>
		<category><![CDATA[online]]></category>
		<guid isPermaLink="false">http://stepansuvorov.com/blog/?p=1688</guid>

					<description><![CDATA[Позвольте представить вашему вниманию мой проектик &#8220;О Я Ору&#8220;. Идея появилась еще 5 лет назад , когда не было демотиваторов (таких, которые мы знаем сейчас) да и никто не понимал, зачем постить текст нарисованный на картинке, когда можно запостить просто &#8230; <a href="https://stepansuvorov.com/blog/2015/03/oyao-ru-%d0%be-%d1%8f-%d0%be%d1%80%d1%83/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
										<content:encoded><![CDATA[<p><a title="http://oyao.ru/" href="http://oyao.ru/"><img decoding="async" class="alignnone size-full wp-image-2415" src="https://stepansuvorov.com/blog/wp-content/uploads/2015/03/Screenshot-2015-03-03-21.03.55.png" alt="oyao.ru logo" width="195" height="64" /></a></p>
<p>Позвольте представить вашему вниманию мой проектик &#8220;<a title="http://oyao.ru/" href="http://oyao.ru/">О Я Ору</a>&#8220;. Идея появилась еще 5 лет назад , когда не было демотиваторов (таких, которые мы знаем сейчас) да и никто не понимал, зачем постить текст нарисованный на картинке, когда можно запостить просто текст. Думаю, я был вдохновлен идеей nah.ru и просто решил ее расширить. Нет, не ругательства расширить &#8211; саму идею расширить: это может быть доброе приветливое сообщение. Но смысл: не написать это текстом, смысл кинуть ссылку (ну либо запостить в соц сети) на рисунок с этим текстом, чтобы придать ей больший эмоциональный оттенок.</p>
<p><span id="more-1688"></span></p>
<p>Сообщения могли бы быть начиная от &#8220;не забудь купить молоко&#8221;, &#8220;просыпайся&#8221; и заканчивая понравившимися цитатами древних философов.</p>
<p>Сейчас уже существует много подобных сайтов и я не претендую на новизну и оригинальность. Приложение было создано скорее для того, чтобы разобраться как работает сервис <strong><a href="https://www.heroku.com/">heroku</a></strong> на каком-то более не менее реальном примере. Действительно очень удобно: просто создаем удаленный репозиторий <strong>heroku</strong> и делаем туда <strong>git push</strong>. Инструкции по установке и запуску сервера прописываем в <strong>package.json</strong>.</p>
<p>Еще поигрался с <strong>canvas</strong> и заставил его конвертировать кусок <strong>HTML</strong> в <strong>png</strong> файл, а потом этот png файл декодить и сохранять в <strong>mongodb</strong> (кстати она тоже предоставляется <strong>heroku</strong> либо партнерским сервисов).</p>
<p>Так же пришлось разобрать <a href="https://stepansuvorov.com/blog/2014/07/the-open-graph-og-protocol/">OG протокол</a>, чтобы фейсбук правильно понимал картинку, которую нужно отображать в превью. Но, так как подлый фейсбук все равно отображал не очень правильно &#8211; я пошел дальше и распарсил хедер его бота и скармливаю ему картинку, вместо html.</p>
<p>Весь стек использованных технологий: <strong>AngularJS</strong>, <strong>Restangular</strong>, <strong>node.js</strong>, <strong>express</strong>, <strong>mongodb</strong>.</p>
<p>Так как и база и сам хостинг бесплатны &#8211; они прилично протормаживают. Это большой минус бесплатного <strong>heroku</strong>.</p>
<p>Большая часть цитат, которые вы можете видеть были тщательно отобраны и записаны мной в процессе тестирования приложения.</p>
<p>Приятного использования.</p>
<p><a title="http://oyao.ru/4eepxc" href="http://oyao.ru/4eepxc"><img decoding="async" fetchpriority="high" class="alignnone  wp-image-2416" src="https://stepansuvorov.com/blog/wp-content/uploads/2015/03/4eepxc.png" alt="oyao.ru example" width="476" height="172" /></a></p>
]]></content:encoded>
					
					<wfw:commentRss>https://stepansuvorov.com/blog/2015/03/oyao-ru-%d0%be-%d1%8f-%d0%be%d1%80%d1%83/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Mongoose для MongoDb</title>
		<link>https://stepansuvorov.com/blog/2012/11/mongoose-%d0%b4%d0%bb%d1%8f-mongodb/</link>
					<comments>https://stepansuvorov.com/blog/2012/11/mongoose-%d0%b4%d0%bb%d1%8f-mongodb/#comments</comments>
		
		<dc:creator><![CDATA[Stepan]]></dc:creator>
		<pubDate>Tue, 27 Nov 2012 20:14:01 +0000</pubDate>
				<category><![CDATA[Хочу сделать мир лучше]]></category>
		<category><![CDATA[MongoDB]]></category>
		<category><![CDATA[mongoose]]></category>
		<guid isPermaLink="false">http://stepansuvorov.com/blog/?p=761</guid>

					<description><![CDATA[Mongoose &#8211; это ORM для MongoDb сделанная под node.js. Традиционно начнем разбор с создания песочницы. Mongoose устанавливается как модуль к node.js: $ npm install mongoose После установки проверяем подключается ли модуль, пишем в test.js файлик следующий код: var mongoose = &#8230; <a href="https://stepansuvorov.com/blog/2012/11/mongoose-%d0%b4%d0%bb%d1%8f-mongodb/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
										<content:encoded><![CDATA[<p><img decoding="async" class="alignnone size-full wp-image-762" title="mongoose" src="https://stepansuvorov.com/blog/wp-content/uploads/2012/11/mongoose.jpg" alt="" width="158" height="194" /></p>
<p><strong>Mongoose</strong> &#8211; это <strong>ORM</strong> для <strong>MongoDb</strong> сделанная под <strong>node.js</strong>.</p>
<p>Традиционно начнем разбор с создания песочницы.</p>
<p>Mongoose устанавливается как модуль к node.js:</p>
<pre>$ npm install mongoose</pre>
<p><span id="more-761"></span></p>
<p>После установки проверяем подключается ли модуль, пишем в <a href="https://stepansuvorov.com/blog/2012/11/%D0%BF%D0%B5%D1%81%D0%BE%D1%87%D0%BD%D0%B8%D1%86%D0%B0-%D0%B4%D0%BB%D1%8F-mongodb/">test.js</a> файлик следующий код:</p>
<pre>var mongoose = require('mongoose');
console.log(mongoose.version);</pre>
<p>и если все прошло успешно, то должно выдать текущую версию <strong>mongoose</strong>.</p>
<p>Чтобы подключится к базе, создаем соединение:</p>
<pre>var db = mongoose.createConnection('mongodb://localhost/test');
//общий синтаксис метода <em>createConnection</em> выглядит слудеющим образом:
//mongoose.connect('mongodb://username:password@host:port/database').</pre>
<p>и открываем его:</p>
<pre>db.on("error", console.error.bind(console, "connection error:"));
db.once("open", function callback () {
    console.log("Connected!")
});</pre>
<p>В mongoose все завязано на 2х ключевых понятиях Схема(<a href="http://mongoosejs.com/docs/guide.html">Schema</a>) &#8211; описание сущности и Модель &#8211; сама сущность.</p>
<p>Создадим схему для комментариев:</p>
<pre>var UserSchema = new mongoose.Schema( {
    name: { type: String, default: "hahaha" },
    age: { type: Number, min: 18, index: true },
    bio: { type: String, match: /[a-z]/ },
    date: { type: Date },
    buff: Buffer
} );</pre>
<p>Каждое поле карактеризуется типом <strong>SchemaTypes</strong> и может иметь дополнительные характеристики: default, min и max(для Number), match и enum(для String), index и unique(для индексов).</p>
<p>Подробнее о типах можно почитать <a href="http://mongoosejs.com/docs/schematypes.html">тут</a>.</p>
<p>Теперь создадим модель по схеме:</p>
<pre>var User = db.model("User",UserSchema)</pre>
<p>и экземпляр для данной модели:</p>
<pre>var newUser = new User({ name: "Alice", age: 21})</pre>
<p>мы можем расширить схему методами:</p>
<pre>UserSchema.methods.speak = function () {
    var greeting = this.name
        ? "My name is " + this.name
        : "I don't have a name"
    console.log(greeting);
}

var User = db.model("User",UserSchema)
var newUser = new User({ name: "Alice", age: 21})
newUser.speak();</pre>
<p>Чтобы сохранить нашего пользователя в базу, мы должны вызвать метод <em>save</em>:</p>
<pre>newUser.save(function (err, newUser) {
    if (err){
        console.log("Something goes wrong with user " + newUser.name);
    }else{
        newUser.speak();
    }
});</pre>
<p>Посмотреть что мы насохраняли в базу и вывести записи для конкретной коллекции(модели) можно так:</p>
<pre>User.find(function (err, users) {
        console.log(users)
    })</pre>
<p>если нам необходимо добавить условие для выборки, тогда так:</p>
<pre>User.find({ name: /^Al/ }, function (err, users) {
        console.log(users)
    })</pre>
<pre>// также существует метод findById</pre>
<p>Кроме обычных методов схема позволяет добавлять сеттеры и геттеры (магические методы):</p>
<pre>UserSchema.path("name").set(
    function( name ) {
        //capitalize
        return name.charAt(0).toUpperCase() + name.slice(1);
});</pre>
<pre>var newUser = new User({ name: "alice"})  //  name will be capitalize</pre>
<p>Кроме <em>set</em> мы еще можем задать <em>get</em> и <em>default</em> магические методы.</p>
<p>Также схема позволяет на каждый метод повесить триггер с колбэком, который будет выполнен до выполенения самого метода. Такой удобный механизм, который позволяет избежать большой вложенности, в MongoDb называется Middleware.</p>
<p>Реализуется следующим образом:</p>
<pre>someSchema.pre(methodName,
    function (next, methodArg1, methodArg2, ...) { 
        // ...
    })</pre>
<p>как пример возмем метод save:</p>
<pre>UserSchema.pre( "save",
    function( next ) {
        // do stuff
        next();
    } );</pre>
<p>по <em>next()</em> запускается следующий триггер.</p>
<p>Используя данный подход мы можем организовать механизм вызова и передачи ошибок:</p>
<pre>UserSchema.pre('save',
         function (next) {
             // something goes wrong
             next(new Error('something went wrong'));
});</pre>
<pre>// later...
newUser.save(function (err) {
    // err can come from a middleware
});</pre>
<p>Также с помощью Middleware можно делать:</p>
<ul>
<li>сложную валидацию</li>
<li>удаление документов по зависимостям</li>
<li>вызов кастомизированых событий</li>
<li>нотификейшены</li>
</ul>
<div><span style="color: #808080;">*Вероятно статья будет дополнена псевдоджоинами и parallel middleware</span></div>
]]></content:encoded>
					
					<wfw:commentRss>https://stepansuvorov.com/blog/2012/11/mongoose-%d0%b4%d0%bb%d1%8f-mongodb/feed/</wfw:commentRss>
			<slash:comments>2</slash:comments>
		
		
			</item>
		<item>
		<title>Репликация MongoDb быстрая настройка</title>
		<link>https://stepansuvorov.com/blog/2012/11/%d1%80%d0%b5%d0%bf%d0%bb%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d1%8f-mongodb-%d0%b1%d1%8b%d1%81%d1%82%d1%80%d0%b0%d1%8f-%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0/</link>
					<comments>https://stepansuvorov.com/blog/2012/11/%d1%80%d0%b5%d0%bf%d0%bb%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d1%8f-mongodb-%d0%b1%d1%8b%d1%81%d1%82%d1%80%d0%b0%d1%8f-%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0/#comments</comments>
		
		<dc:creator><![CDATA[Stepan]]></dc:creator>
		<pubDate>Tue, 27 Nov 2012 15:34:01 +0000</pubDate>
				<category><![CDATA[Хочу сделать мир лучше]]></category>
		<category><![CDATA[MongoDB]]></category>
		<category><![CDATA[replication]]></category>
		<guid isPermaLink="false">http://stepansuvorov.com/blog/?p=757</guid>

					<description><![CDATA[MongoDb поддерживает 2 формы репликации: реплисеты(Replica Sets ) и ведущий-ведомый(Master-Slave). Рекомендуется использовать более новый подход &#8211; реплисеты. О реплисетах  можно подробно прочесть на официальном сайте. Мы в свою чередь разберем как можно быстро создать и настроить данный вид репликации. Когда мы говорим &#8230; <a href="https://stepansuvorov.com/blog/2012/11/%d1%80%d0%b5%d0%bf%d0%bb%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d1%8f-mongodb-%d0%b1%d1%8b%d1%81%d1%82%d1%80%d0%b0%d1%8f-%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
										<content:encoded><![CDATA[<p><img decoding="async" loading="lazy" class="alignnone size-medium wp-image-758" title="mongodb_replication" src="https://stepansuvorov.com/blog/wp-content/uploads/2012/11/mongodb_replication-300x300.png" alt="" width="300" height="300" srcset="https://stepansuvorov.com/blog/wp-content/uploads/2012/11/mongodb_replication-300x300.png 300w, https://stepansuvorov.com/blog/wp-content/uploads/2012/11/mongodb_replication-150x150.png 150w, https://stepansuvorov.com/blog/wp-content/uploads/2012/11/mongodb_replication.png 450w" sizes="(max-width: 300px) 100vw, 300px" /></p>
<p><strong>MongoDb</strong> поддерживает 2 формы <strong>репликации</strong>: <strong>реплисеты</strong>(Replica Sets ) и <strong>ведущий-ведомый</strong>(Master-Slave). Рекомендуется использовать более новый подход &#8211; реплисеты.</p>
<p>О реплисетах  можно подробно прочесть на <a href="http://ru.wiki.mongodb.org/display/DOCS/Replica+Sets">официальном сайте</a>. Мы в свою чередь разберем как можно быстро создать и настроить данный вид репликации.</p>
<p><span id="more-757"></span>Когда мы говорим о репликации, мы подразумеваем, что у нас есть несколько баз. Для локальных экспериментов можно запустить несколько демонов указав им разные порты и директории для баз.</p>
<p>Создадим несколько директорий для экспериментальных баз:</p>
<pre>$ mkdir db1</pre>
<pre>$ mkdir db2</pre>
<pre>$ mkdir db3</pre>
<p>Запуск демона MongoDb (mongod) выполняется следующей командой</p>
<pre>$ mongod</pre>
<p>если хотим указать путь к базе и порт, тогда так:</p>
<pre>$ mongod --dbpath db1 --port 27001</pre>
<p>плюс добавим еще параметр указывающий на то что это репликасет:</p>
<pre>$ mongod --dbpath db1 --port 27001 --replSet myreplica</pre>
<p><em>myreplica</em> &#8211; в данном случае имя для нашего репликасета.</p>
<p>Теперь таким же образом запускаем еще 2 демона:</p>
<pre>$ mongod --dbpath db2 --port 27002 --replSet myreplica</pre>
<pre>$ mongod --dbpath db3 --port 27003 --replSet myreplica</pre>
<p>В итоге у нас подготовлены 3 базы и нам следует теперь распределить между ними роли: кто будет <strong>Первичным</strong>(Primary) звеном, к которому будут добавлены остальные.</p>
<p>Допустим мы решили сделать db1 главным. Для этого заходим на него используя mongoshell :</p>
<pre>$ mongo --port 27001</pre>
<p>и делаем</p>
<pre>mongo&gt; rs.initiate()</pre>
<p>для инициализации конфигурации.</p>
<p>Все манипуляции с репликасетом выполняются с помощью методов объекта <strong>rs</strong>. Весь список методов пожно получить выполнив команду <em>rs.help()</em>.</p>
<p>Проверим статус нашего репликасета:</p>
<pre>mongo&gt; rs.status()</pre>
<p>как видим в свойстве <em>members</em> присутсвует только текущий сервер, для того чтобы добавить остальные делаем:</p>
<pre>mongo&gt; rs.add("myhost:27002")</pre>
<pre>mongo&gt; rs.add("myhost:27003")</pre>
<p><em>myhost</em> &#8211; имя нашего хоста (должно быть написано при выводе <em>rs.status()</em>)</p>
<p>Выволним еще раз <em>rs.status()</em> и убедимся что базы были добавлены.</p>
<p>Вот и все. Старался передать материал максимально просто. За более полной информацией по конфигурированию можно обратиться к <a href="http://docs.mongodb.org/manual/reference/replica-configuration/">офсайт докам</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://stepansuvorov.com/blog/2012/11/%d1%80%d0%b5%d0%bf%d0%bb%d0%b8%d0%ba%d0%b0%d1%86%d0%b8%d1%8f-mongodb-%d0%b1%d1%8b%d1%81%d1%82%d1%80%d0%b0%d1%8f-%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b9%d0%ba%d0%b0/feed/</wfw:commentRss>
			<slash:comments>3</slash:comments>
		
		
			</item>
		<item>
		<title>Песочница для mongodb</title>
		<link>https://stepansuvorov.com/blog/2012/11/%d0%bf%d0%b5%d1%81%d0%be%d1%87%d0%bd%d0%b8%d1%86%d0%b0-%d0%b4%d0%bb%d1%8f-mongodb/</link>
					<comments>https://stepansuvorov.com/blog/2012/11/%d0%bf%d0%b5%d1%81%d0%be%d1%87%d0%bd%d0%b8%d1%86%d0%b0-%d0%b4%d0%bb%d1%8f-mongodb/#comments</comments>
		
		<dc:creator><![CDATA[Stepan]]></dc:creator>
		<pubDate>Sat, 10 Nov 2012 20:21:22 +0000</pubDate>
				<category><![CDATA[Хочу сделать мир лучше]]></category>
		<category><![CDATA[javascript]]></category>
		<category><![CDATA[MongoDB]]></category>
		<category><![CDATA[node.js]]></category>
		<category><![CDATA[webStorm]]></category>
		<guid isPermaLink="false">http://stepansuvorov.com/blog/?p=728</guid>

					<description><![CDATA[Проходя курсы по mongoDb остро стала необходимость в организации какой-то песочницы для скриптов, так как просто в mongoshell писать стало не удобно, а отдельно писать в редакторе код, а потом его запускать через консоль &#8211; тоже не интересно. Покопавшись в &#8230; <a href="https://stepansuvorov.com/blog/2012/11/%d0%bf%d0%b5%d1%81%d0%be%d1%87%d0%bd%d0%b8%d1%86%d0%b0-%d0%b4%d0%bb%d1%8f-mongodb/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
										<content:encoded><![CDATA[<p>Проходя <a href="https://education.10gen.com">курсы по mongoDb</a> остро стала необходимость в организации какой-то <strong>песочницы</strong> для скриптов, так как просто в <strong>mongoshell</strong> писать стало не удобно, а отдельно писать в редакторе код, а потом его запускать через консоль &#8211; тоже не интересно.</p>
<p><span id="more-728"></span>Покопавшись в плагинах <strong>WebStorm</strong> (который является моим текущим IDE), я обнаружил, что для <strong>mongoDb</strong> расширения, увы, еще нет. Ну что же, играем дальше. Есть плагин на <strong>node.js</strong>, который довольно просто настраивается. После чего можем в настройках запуска проекта</p>
<p><img decoding="async" loading="lazy" class="alignnone size-medium wp-image-729" title="webstorm_run" src="https://stepansuvorov.com/blog/wp-content/uploads/2012/11/webstorm_run-300x186.jpg" alt="" width="300" height="186" srcset="https://stepansuvorov.com/blog/wp-content/uploads/2012/11/webstorm_run-300x186.jpg 300w, https://stepansuvorov.com/blog/wp-content/uploads/2012/11/webstorm_run.jpg 323w" sizes="(max-width: 300px) 100vw, 300px" /></p>
<p>добавить вариант запуска текущего скрипта нодой.</p>
<p>Надеюсь, вы не забыли поставить <a href="https://stepansuvorov.com/blog/2012/10/node-js-%D0%B8-mongodb/">монго драйвер на ноду</a>.</p>
<p>Итак, у нас есть удобный редактор, подключенная нода и консольный вывод в самом редакторе. Осталось только накидать код:</p>
<pre>var mongo = require('mongodb');
var host = 'localhost';
var port = mongo.Connection.DEFAULT_PORT;

var db = new mongo.Db('test', new mongo.Server(host, port, {}), {safe:false});
db.open(function(err, db) {
    console.log("Connected!");

    // а вот тут и пишем наш код, который хотим отладить

    db.close();
});</pre>
<p>Happy codding!</p>
]]></content:encoded>
					
					<wfw:commentRss>https://stepansuvorov.com/blog/2012/11/%d0%bf%d0%b5%d1%81%d0%be%d1%87%d0%bd%d0%b8%d1%86%d0%b0-%d0%b4%d0%bb%d1%8f-mongodb/feed/</wfw:commentRss>
			<slash:comments>1</slash:comments>
		
		
			</item>
		<item>
		<title>Node.js и MongoDB</title>
		<link>https://stepansuvorov.com/blog/2012/10/node-js-%d0%b8-mongodb/</link>
					<comments>https://stepansuvorov.com/blog/2012/10/node-js-%d0%b8-mongodb/#comments</comments>
		
		<dc:creator><![CDATA[Stepan]]></dc:creator>
		<pubDate>Tue, 16 Oct 2012 06:41:24 +0000</pubDate>
				<category><![CDATA[Хочу сделать мир лучше]]></category>
		<category><![CDATA[MongoDB]]></category>
		<category><![CDATA[node.js]]></category>
		<guid isPermaLink="false">http://stepansuvorov.com/blog/?p=677</guid>

					<description><![CDATA[Попробуем подружить MongoDB и Node.js. Договоримся что нода у нас уже стоит, если нет идем по тегу Node.js, и разбираемся, а потом возвращаемся сюда доставлять mongoDB. Чтобы поставить MongoDB на Ubuntu(12.04) выполняем следующую команду: $ apt-get install mongodb Чтобы проверить &#8230; <a href="https://stepansuvorov.com/blog/2012/10/node-js-%d0%b8-mongodb/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
										<content:encoded><![CDATA[<p><img decoding="async" loading="lazy" class="alignnone size-full wp-image-678" title="logo-mongodb" src="https://stepansuvorov.com/blog/wp-content/uploads/2012/10/logo-mongodb.png" alt="" width="217" height="90" /></p>
<p>Попробуем подружить MongoDB и Node.js.</p>
<p><span id="more-677"></span>Договоримся что нода у нас уже стоит, если нет идем по тегу <a href="https://stepansuvorov.com/blog/tag/node-js/">Node.js</a>, и разбираемся, а потом возвращаемся сюда доставлять mongoDB.</p>
<p>Чтобы поставить MongoDB на Ubuntu(12.04) выполняем следующую команду:</p>
<pre>$ apt-get install mongodb</pre>
<p>Чтобы проверить правильно ли поставилось запускаем:</p>
<pre>$ /usr/bin/mongo</pre>
<p>Должно зайти в программу и выдать что-то типа:</p>
<pre>MongoDB shell version: 2.0.4
connecting to: test</pre>
<p>Далее устанавливаем дополнительный пакет на ноду:</p>
<pre>$ npm install mongodb</pre>
<p>если мы будем использовать во всех проектах монго, то имеет смысл поставить флажок <em>-g</em> &#8220;для всех&#8221;:</p>
<pre>$ npm install mongodb -g</pre>
<p>!Внимание. Предварительно может потребовать установить пакет <em>node-gyp</em>.</p>
<pre>$ npm install node-gyp -g</pre>
<p>Есть. Проверим через простой скрипт <em>test.js</em> установился ли модуль, содержание:</p>
<pre>var mongo = require('mongodb');</pre>
<p>Выполняем:</p>
<pre>$ node test.js</pre>
<p>Если ошибок не выдало, можно еще немного расширить наш скрипт:</p>
<pre>var mongo = require('mongodb');
var host = 'localhost';
var port = mongo.Connection.DEFAULT_PORT;

var db = new mongo.Db('test', new mongo.Server(host, port, {}), {safe:false});
db.open(function(err, db) {
    console.log("Connected!");
    db.close();
});</pre>
<p>&#8211; создали объект базы, подключились к базе, закрыли соединение.</p>
<p>Немного расширим наш скрипт, добавим запись и чтение информации из базы:</p>
<pre>...
var db = new mongo.Db('test', new mongo.Server(host, port,{}), {safe:false});
db.open(function(err, db) {
    console.log("Connected!");

    var collection = db.collection("simple_collection");
    collection.insert({hello:'world'});

    collection.findOne({hello:'world'}, function(err, item) {
        console.log(item);
        db.close();
    })

});</pre>
<p>Чтобы добавить несколько записей можно сделать так:</p>
<pre>collection.insert([{hello:'world'}, {hello:'world2'}, {hello:'world3'}]);</pre>
<p>Думаю будет еще один пост непосредственно о использовании MongoDB, а в этом пока все.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://stepansuvorov.com/blog/2012/10/node-js-%d0%b8-mongodb/feed/</wfw:commentRss>
			<slash:comments>1</slash:comments>
		
		
			</item>
	</channel>
</rss>
