<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>grunt &#8211; Stepan Suvorov Blog</title>
	<atom:link href="https://stepansuvorov.com/blog/tag/grunt/feed/" rel="self" type="application/rss+xml" />
	<link>https://stepansuvorov.com/blog</link>
	<description>Release 2.0</description>
	<lastBuildDate>Fri, 06 May 2016 10:48:12 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=6.3.1</generator>
	<item>
		<title>Idea: Grunt/gulp/webpack config builder</title>
		<link>https://stepansuvorov.com/blog/2016/05/grunt-gulp-webpack-config-builder/</link>
					<comments>https://stepansuvorov.com/blog/2016/05/grunt-gulp-webpack-config-builder/#comments</comments>
		
		<dc:creator><![CDATA[Stepan]]></dc:creator>
		<pubDate>Sat, 07 May 2016 10:39:28 +0000</pubDate>
				<category><![CDATA[start me up]]></category>
		<category><![CDATA[config]]></category>
		<category><![CDATA[grunt]]></category>
		<category><![CDATA[online]]></category>
		<category><![CDATA[tool]]></category>
		<guid isPermaLink="false">http://stepansuvorov.com/blog/?p=2127</guid>

					<description><![CDATA[I don&#8217;t know why such kind of service still have not been invented. It&#8217;s not only about grunt/gulp or webpack but also about build tools of such kind. It could be so useful: you just feed your github repo to the &#8230; <a href="https://stepansuvorov.com/blog/2016/05/grunt-gulp-webpack-config-builder/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
										<content:encoded><![CDATA[<p><img decoding="async" class="alignnone  wp-image-3069" src="https://stepansuvorov.com/blog/wp-content/uploads/2016/05/grunt-logo.png" alt="grunt-logo" width="165" height="165" /><img decoding="async" class="alignnone  wp-image-3070" src="https://stepansuvorov.com/blog/wp-content/uploads/2016/05/gulp-2x.png" alt="gulp-2x" width="72" height="150" /><img decoding="async" class="alignnone  wp-image-3072" src="https://stepansuvorov.com/blog/wp-content/uploads/2016/05/1-A-_KrEvMuiH7dlwshFw5aw.png" alt="1-A-_KrEvMuiH7dlwshFw5aw" width="223" height="149" /></p>
<p>I don&#8217;t know why such kind of service still have not been invented. It&#8217;s not only about grunt/gulp or webpack but also about build tools of such kind.</p>
<p>It could be so useful: you just feed your github repo to the service and in step by step wizard create your config file. After all you have pull request with changes(new config file) to your project.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://stepansuvorov.com/blog/2016/05/grunt-gulp-webpack-config-builder/feed/</wfw:commentRss>
			<slash:comments>4</slash:comments>
		
		
			</item>
		<item>
		<title>Автоматизируем тестирование AngularJS с Protractor</title>
		<link>https://stepansuvorov.com/blog/2014/11/protractor/</link>
					<comments>https://stepansuvorov.com/blog/2014/11/protractor/#comments</comments>
		
		<dc:creator><![CDATA[Stepan]]></dc:creator>
		<pubDate>Tue, 18 Nov 2014 19:02:58 +0000</pubDate>
				<category><![CDATA[Хочу сделать мир лучше]]></category>
		<category><![CDATA[AngularJs]]></category>
		<category><![CDATA[grunt]]></category>
		<category><![CDATA[javascript]]></category>
		<category><![CDATA[protractor]]></category>
		<category><![CDATA[tests]]></category>
		<guid isPermaLink="false">http://stepansuvorov.com/blog/?p=2011</guid>

					<description><![CDATA[О том как установить и запустить Protractor уже было в этом посте &#8211; Тестируем AngularJS используя Protractor. А сейчас мы сделаем фокус  на том, как мы можем интегрировать Protractor в нашу систему и подкючить к Grunt. Подключаем Protractor к Grunt &#8230; <a href="https://stepansuvorov.com/blog/2014/11/protractor/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
										<content:encoded><![CDATA[<p><img decoding="async" loading="lazy" class="alignnone size-medium wp-image-2012" title="grunt+angular+protractor" src="https://stepansuvorov.com/blog/wp-content/uploads/2014/10/falgg2jybmhgk16y62lr-300x300.png" alt="" width="300" height="300" srcset="https://stepansuvorov.com/blog/wp-content/uploads/2014/10/falgg2jybmhgk16y62lr-300x300.png 300w, https://stepansuvorov.com/blog/wp-content/uploads/2014/10/falgg2jybmhgk16y62lr-150x150.png 150w, https://stepansuvorov.com/blog/wp-content/uploads/2014/10/falgg2jybmhgk16y62lr.png 500w" sizes="(max-width: 300px) 100vw, 300px" /></p>
<p>О том как установить и запустить <strong><a title="angular.github.io/protractor" href="http://angular.github.io/protractor/#/">Protractor</a></strong> уже было в этом посте &#8211; <a title="angularjs-protractor" href="https://stepansuvorov.com/blog/2014/02/angularjs-protractor/">Тестируем AngularJS используя Protractor</a>. А сейчас мы сделаем фокус  на том, как мы можем интегрировать <strong>Protractor</strong> в нашу систему и подкючить к <strong><a title="gruntjs" href="http://gruntjs.com/">Grunt</a></strong>.</p>
<p><span id="more-2011"></span></p>
<h2>Подключаем Protractor к Grunt</h2>
<p>Для подключение нам необходимо поставить специальный таск-плагин <a title="npmjs.org" href="https://www.npmjs.org/package/grunt-protractor-runner">grunt-protractor-runner</a> к grunt путем выполнения следующей команды:</p>
<pre>$ npm install grunt-protractor-runner</pre>
<p>После чего можем дополнить наш конфигурационный файл секцией для него:</p>
<p>[javascript]<br />
protractor: {<br />
  options: {<br />
    configFile: &quot;protractor.conf.js&quot;<br />
  },<br />
  all: {}<br />
}<br />
[/javascript]</p>
<p><strong>protractor.conf.js</strong> &#8211; конфигурационный файл, который уже у нас есть (создание подробно описано в <a href="https://stepansuvorov.com/blog/2014/02/angularjs-protractor/">предыдущем посте</a>)</p>
<p><strong>all: {}</strong> &#8211; grunt требует как минимум один &#8220;target&#8221;, поэтому, если все параметры уже указаны в конфиге протрактора, то можем просто добавить пустую сецию.</p>
<p>Проверим что мы все правильно настроили и команда выполняется без ошибок:</p>
<p>[bash]<br />
$ grunt protractor:all<br />
[/bash]</p>
<h2>PhantomJS и Protractor</h2>
<p>В случае, когда мы хотим запускать наши тесты не только локально, но и на сервере, где нет возможности использовать браузер на помощь спешит <a title="phantomjs.org" href="http://phantomjs.org/">PhantomJS</a>. Ознакомиться с <strong>PhantomJS</strong> вы можете в посте &#8211; <a href="https://stepansuvorov.com/blog/2012/09/%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%B5%D0%BC-%D1%8E%D0%BD%D0%B8%D1%82-%D1%82%D0%B5%D1%81%D1%82%D1%8B-%D1%81-phantomjs/">Создаем юнит-тесты с phantomjs</a>, а сейчас мы поговорим о том как его встроить в Protractor.</p>
<p>Теперь вместо вебдрайвера мы должны запустить фантом-сервер:</p>
<pre>$ phantomjs --webdriver=4444</pre>
<p>а наша секция grunt конфига преобразиться следующим образом:</p>
<p>[javascript]<br />
protractor: {<br />
  options: {<br />
    configFile: &quot;protractor.conf.js&quot;<br />
  },<br />
  all: {<br />
        options: {<br />
          args:{<br />
            seleniumAddress: &#8216;http://localhost:4444&#8217;,<br />
            capabilities: {<br />
              browserName: &#8216;phantomjs&#8217;<br />
            }<br />
          }<br />
        }<br />
      }<br />
}<br />
[/javascript]</p>
<p>иногда бывает необходимо специфицировать конкретную версию/путь к phantomjs, тогда добавляем еще одну опцию &#8211; <strong>phantomjs.binary.path</strong>, а аргументы к фантому можем передавать через опцию <strong>phantomjs.cli.args</strong>; итого получим:</p>
<p>[javascript]<br />
protractor: {<br />
  options: {<br />
    configFile: &quot;protractor.conf.js&quot;<br />
  },<br />
  all: {<br />
        options: {<br />
          args:{<br />
            seleniumAddress: &#8216;http://localhost:4444&#8217;,<br />
            capabilities: {<br />
              browserName: &#8216;phantomjs&#8217;,<br />
              &#8216;phantomjs.binary.path&#8217;:&#8217;./node_modules/.bin/phantomjs&#8217;,<br />
              &#8216;phantomjs.cli.args&#8217;: [&#8216;&#8211;ignore-ssl-errors=true&#8217;,  &#8216;&#8211;web-security=false&#8217;]<br />
            }<br />
          }<br />
        }<br />
      }<br />
}<br />
[/javascript]</p>
<p>Если мы хотим, чтобы вебдрайвер запустил фантом за нас, то просто не указываем параметр <strong>seleniumAddress</strong>.</p>
<h2>Отладка тест-сценариев в WebStorm</h2>
<p>Пару слов о том как можно дебажить тесты в WebStorm. Что для этого нужно сделать:</p>
<p>Открываем настройки Run/Debug:</p>
<p><img decoding="async" loading="lazy" class="alignnone size-full wp-image-2029" title="webstorm edit run configuration" src="https://stepansuvorov.com/blog/wp-content/uploads/2014/10/Screenshot-2014-10-20-17.51.44.png" alt="" width="119" height="42" /></p>
<p>Добравляем новую конфигурацию для Node.js:</p>
<p><img decoding="async" loading="lazy" class="alignnone size-medium wp-image-2030" title="webstorm node.js config" src="https://stepansuvorov.com/blog/wp-content/uploads/2014/10/Screenshot-2014-10-20-17.57.17-263x300.png" alt="" width="263" height="300" srcset="https://stepansuvorov.com/blog/wp-content/uploads/2014/10/Screenshot-2014-10-20-17.57.17-263x300.png 263w, https://stepansuvorov.com/blog/wp-content/uploads/2014/10/Screenshot-2014-10-20-17.57.17.png 326w" sizes="(max-width: 263px) 100vw, 263px" /></p>
<p>Прописываем следующие ключевые настройки:</p>
<ul>
<li><strong>Working directory</strong>: корневой путь вашего проекта (например: ‘<em>/Users/stevermeister/workspace/academy-js</em>’)</li>
<li><strong>JavaScript file</strong>: путь к cli.js файлу протрактора (как правило это <em>node_modules\protractor\lib\cli.js</em>)</li>
<li><strong>Application parameters</strong>: путь к файлу конфиг файлу протрактора(например: <em>protractor.conf.js</em>)</li>
</ul>
<div><img decoding="async" loading="lazy" class="alignnone size-full wp-image-2032" title="webstorm protractor config" src="https://stepansuvorov.com/blog/wp-content/uploads/2014/10/Screenshot-2014-10-20-18.09.011.png" alt="" width="710" height="379" srcset="https://stepansuvorov.com/blog/wp-content/uploads/2014/10/Screenshot-2014-10-20-18.09.011.png 710w, https://stepansuvorov.com/blog/wp-content/uploads/2014/10/Screenshot-2014-10-20-18.09.011-300x160.png 300w, https://stepansuvorov.com/blog/wp-content/uploads/2014/10/Screenshot-2014-10-20-18.09.011-500x266.png 500w" sizes="(max-width: 710px) 100vw, 710px" /></div>
<p>Сохраняем. Готово:</p>
<p><a href="https://stepansuvorov.com/blog/wp-content/uploads/2014/10/Screenshot-2014-10-20-18.11.27.png"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-2033" title="webstorm protractor debug" src="https://stepansuvorov.com/blog/wp-content/uploads/2014/10/Screenshot-2014-10-20-18.11.27.png" alt="" width="169" height="39" /></a></p>
<p>Теперь можно проставлять бреймпоинты и дебажить.</p>
<h2>Подключение вспомогательных файлов</h2>
<p>Иногда возникает необходимость подключить файлы, которые не являются тест сценариями, но, в которых содержится вспомогательный функционал(например логин). Для этого необходимо подключаем файл сделать формата модуля <strong>node.js </strong>(<a title="Node-Require-and-Exports" href="http://openmymind.net/2012/2/3/Node-Require-and-Exports/">module.exports</a>), то есть(helpers.js):</p>
<p>[javascript]<br />
function login(){<br />
//&#8230;<br />
}<br />
function logout(){<br />
//&#8230;<br />
}<br />
var Helper = {};<br />
Helper.login = login;<br />
Helper.logout = logout;<br />
[/javascript]</p>
<p>и потом подключить в файле сценария:</p>
<p>[javascript]<br />
var helpers = require(&#8216;./helpers&#8217;);<br />
helpers.login();<br />
[/javascript]</p>
<p>Для тех, кто ранее не работал с таким синтаксисом, подчеркну: расширение &#8220;<em>.js</em>&#8221; в данном случае не пишется.</p>
<p><span style="color: #000000; font-weight: bold;">Примеры тест сценариев</span></p>
<h2>Авторизация пользователя в приложении:</h2>
<p>[javascript]<br />
describe(&#8216;Auth Module&#8217;, function() {<br />
  var ptor = protractor.getInstance();</p>
<p>  it(&#8216;should login user&#8217;, function() {<br />
    browser.get(&#8216;/login&#8217;);<br />
    browser.waitForAngular();</p>
<p>    element(by.model(&#8216;username&#8217;)).sendKeys(browser.params.login.user);<br />
    element(by.model(&#8216;password&#8217;)).sendKeys(browser.params.login.password);<br />
    element.all(by.css(&#8216;.button&#8211;primary&#8217;)).first().click();</p>
<p>    element(by.binding(&#8216;user.name&#8217;)).getText().then(function(username) {<br />
      expect(username).equal(browser.params.login.username);<br />
    });<br />
    ptor.getCurrentUrl().then(function(url) {<br />
      expect(url.slice(-10)).equal(&#8216;/dashboard&#8217;);<br />
    });<br />
  });<br />
});<br />
[/javascript]</p>
<p>Параметры типа пароля в тестах, понятное дело лучше не держать. Здесь они вынесены в отдельную секцию конфига протрактора (да, согласен, тоже не комильфо, но всеравно лучше, чем прям в тестах):</p>
<p>[javascript]<br />
params: {<br />
  login: {<br />
    user: &#8216;stepan@mail.com&#8217;,<br />
    password: &#8216;XXXXXXXXX&#8217;,<br />
    username: &#8216;Stepan Suvorov&#8217;<br />
  }<br />
}<br />
[/javascript]</p>
<h2>Покупка продукта</h2>
<p>[javascript]<br />
describe(&#8216;Purchase item&#8217;, function() {<br />
  var ptor = protractor.getInstance();</p>
<p>  beforeEach(function() {<br />
    helpers.logout();<br />
    helpers.login();<br />
    browser.sleep(3000);<br />
  });</p>
<p>  it(&#8216;should purchase an item&#8217;, function() {</p>
<p>    browser.get(&#8216;/items/552/buy&#8217;);<br />
    browser.sleep(3000);<br />
    element(by.css(&#8216;.modal-window__block .button&#8211;primary&#8217;)).click();</p>
<p>    ptor.ignoreSynchronization = true;</p>
<p>    element(by.css(&#8216;#mainSubmit&#8217;)).click();<br />
    element(by.css(&#8216;input[type=&quot;submit&quot;]&#8217;)).click();</p>
<p>    ptor.ignoreSynchronization = false;<br />
  });<br />
});<br />
[/javascript]</p>
<p>хотел бы отметить очень важный момент в этом куске кода:</p>
<p>[javascript]<br />
ptor.ignoreSynchronization = true;<br />
[/javascript]</p>
<p>этим мы говорим протрактору, что мы покидаем приложение и переходим на страницу без AngularJS.</p>
<h2>Поиск по каталогу</h2>
<p>[javascript]<br />
describe(&#8216;Search&#8217;, function() {<br />
  it(&#8216;should do search&#8217;, function() {</p>
<p>    browser.get(&#8216;/items&#8217;);<br />
    element(by.model(&#8216;itemsSearch.query&#8217;)).sendKeys(&#8216;iBrick&#8217;, protractor.Key.ENTER);</p>
<p>    element.all(by.repeater(&#8216;item in items&#8217;)).then(function(rows) {<br />
      var itemTitleElement = rows[0].element(by.className(&#8216;item-tile__name&#8217;));<br />
      itemTitleElement.getText().then(function(itemTitle) {<br />
        expect(itemTitle).equal(&#8216;iBrick Plus&#8217;);<br />
      })</p>
<p>    });<br />
  });<br />
});<br />
[/javascript]</p>
<p>&nbsp;</p>
<h2>Дополнительно</h2>
<ul>
<li><a title="egghead.io" href="https://egghead.io/lessons/angularjs-protractor-interactive">Protractor Interactive (видео от Egghead)</a></li>
<li><a title="stackoverflow.com" href="http://stackoverflow.com/a/25008031/274500">Развернутый ответ на стеке по поводу возможных ошибок</a></li>
</ul>
]]></content:encoded>
					
					<wfw:commentRss>https://stepansuvorov.com/blog/2014/11/protractor/feed/</wfw:commentRss>
			<slash:comments>3</slash:comments>
		
		
			</item>
		<item>
		<title>grunt-complexity</title>
		<link>https://stepansuvorov.com/blog/2014/06/grunt-complexity/</link>
					<comments>https://stepansuvorov.com/blog/2014/06/grunt-complexity/#respond</comments>
		
		<dc:creator><![CDATA[Stepan]]></dc:creator>
		<pubDate>Tue, 17 Jun 2014 20:33:45 +0000</pubDate>
				<category><![CDATA[Хочу сделать мир лучше]]></category>
		<category><![CDATA[grunt]]></category>
		<category><![CDATA[grunt-complexity]]></category>
		<category><![CDATA[javascript]]></category>
		<guid isPermaLink="false">http://stepansuvorov.com/blog/?p=1728</guid>

					<description><![CDATA[В добавок к валидации кода и покрытия юнит-тестами я прикрутил интересную штуку для проекта &#8211; grunt-complexity &#8211; оценку сложности кода. Установка &#8211; npm пакет: $ npm install grunt-complexity Конфигурирование в grunt-файле: [javascript] complexity: { generic: { src: [&#8216;grunt.js&#8217;, &#8216;tasks/grunt-complexity.js&#8217;], options: &#8230; <a href="https://stepansuvorov.com/blog/2014/06/grunt-complexity/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
										<content:encoded><![CDATA[<p>В добавок к валидации кода и покрытия юнит-тестами я прикрутил интересную штуку для проекта &#8211; <strong><a href="https://github.com/vigetlabs/grunt-complexity">grunt-complexity</a></strong> &#8211; оценку сложности кода.</p>
<p><span id="more-1728"></span>Установка &#8211; npm пакет:</p>
<pre>$ npm install grunt-complexity</pre>
<p>Конфигурирование в grunt-файле:</p>
<p>[javascript]<br />
complexity: {<br />
  generic: {<br />
    src: [&#8216;grunt.js&#8217;, &#8216;tasks/grunt-complexity.js&#8217;],<br />
    options: {<br />
      errorsOnly: false,<br />
      cyclomatic: 3,<br />
      halstead: 8,<br />
      maintainability: 100<br />
    }<br />
  }<br />
}<br />
[/javascript]</p>
<p>И запустив:</p>
<pre>$ grunt complexity</pre>
<p>Получим такую интересную картинку:</p>
<p><img decoding="async" loading="lazy" class="alignnone size-full wp-image-1752" title="grunt-complexity" src="https://stepansuvorov.com/blog/wp-content/uploads/2014/06/example.png" alt="grunt-complexity" width="462" height="202" srcset="https://stepansuvorov.com/blog/wp-content/uploads/2014/06/example.png 462w, https://stepansuvorov.com/blog/wp-content/uploads/2014/06/example-300x131.png 300w" sizes="(max-width: 462px) 100vw, 462px" /></p>
<p>Теперь давайте разберем что же все таки такое <strong>complexity</strong> и из каких параметров она складывается.</p>
<h2>Строчки кода (Line of Code or LoC)</h2>
<p>Это может быть либо физическое количество (строчек кода в файле) либо логическое (считаются только строчки с операторами)</p>
<h2>Количество парамтров (Number of Parameters)</h2>
<p>Анализируется семантически(по описанию функции) и без учета использования <strong>arguments</strong>.</p>
<h2>Цикломатическая сложность (Cyclomatic Complexity)</h2>
<p>Количество всевозможных проходов блока кода</p>
<h2>Цикломатическая <span style="color: #000000; font-weight: bold;">плотность </span><span style="color: #000000; font-weight: bold;">(Cyclomatic Complexity Density)</span></h2>
<p>Отношение циклической сложности к логическому количеству строк кода</p>
<h2>Критерии сложности Хальстеда (Halstead Complexity Measurement)</h2>
<p>Основывается на количестве операторов и операндов в конкретной функции. Выделяют 3 основных критерия: Difficulty, Volume, Effort, которые могут быть получены по следующим формулам:</p>
<div>
<pre>Difficulty = (# distinct operators / 2) * (# operands / # distinct operands)
Volume = (# operators + # operands) * log2(# distinct operators + # distinct operands)
Effort = difficulty * volume</pre>
<h2>Индекс <em>поддержки</em> (Maintainability Index)</h2>
<p>Чтобы посчитать его мы должны использовать 3 уже описанные параметра:</p>
<pre> Maintainability =  171 - (3.42 * ln(effort)) - (0.23 * ln(cyclomatic complexity)) - (16.2 * ln(logical LOC))</pre>
</div>
<p>Исходя из этой формулы делаем вывод что индекс может иметь значение от минус бесконечности до <strong>171</strong>. И чем выше индекс &#8211; тем код более поддерживаемый.</p>
<div>С первого взгляда кажется более чем сложно, но в процессе работы, когда все делает одной командой, а еще лучше просто автоматизировано и выполняется вместе с тестами, &#8211; помогает найти слабыем места и вовремя их исправить.</div>
<div>Прошу прощения за очень вольный перевод терминов, если где-то неточность &#8211; поправьте пожалуйста.</div>
]]></content:encoded>
					
					<wfw:commentRss>https://stepansuvorov.com/blog/2014/06/grunt-complexity/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Сделаем gulp javascript проекту</title>
		<link>https://stepansuvorov.com/blog/2014/03/gulp/</link>
					<comments>https://stepansuvorov.com/blog/2014/03/gulp/#respond</comments>
		
		<dc:creator><![CDATA[Stepan]]></dc:creator>
		<pubDate>Tue, 04 Mar 2014 14:48:07 +0000</pubDate>
				<category><![CDATA[Хочу сделать мир лучше]]></category>
		<category><![CDATA[grunt]]></category>
		<category><![CDATA[gulp]]></category>
		<category><![CDATA[javascript]]></category>
		<guid isPermaLink="false">http://stepansuvorov.com/blog/?p=1417</guid>

					<description><![CDATA[Gulp.js это потоковый сборщик проектов на JavaScript, интересная альтернатива Grunt.js. Установка сначала глобально, чтобы можно было вызывать из командной строки: $ sudo npm install gulp -g потом локально, в папку проекта, чтобы его могла вызывать нода: $ npm install gulp проверим: $ &#8230; <a href="https://stepansuvorov.com/blog/2014/03/gulp/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
										<content:encoded><![CDATA[<p><img decoding="async" loading="lazy" class="alignnone size-full wp-image-1514" title="gulp logo" src="https://stepansuvorov.com/blog/wp-content/uploads/2014/03/gulp.png" alt="" width="114" height="257" /></p>
<p><a href="http://gulpjs.com/">Gulp.js</a> это потоковый сборщик проектов на <strong>JavaScript</strong>, интересная альтернатива <a title="gruntjs.com" href="http://gruntjs.com/">Grunt.js</a>.</p>
<h2><span id="more-1417"></span>Установка</h2>
<p>сначала глобально, чтобы можно было вызывать из командной строки:</p>
<pre>$ sudo npm install gulp -g</pre>
<p>потом локально, в папку проекта, чтобы его могла вызывать нода:</p>
<pre>$ npm install gulp</pre>
<p>проверим:</p>
<pre>$ gulp --version
[gulp] CLI version 3.5.2
[gulp] Local version 3.5.2</pre>
<p>установка <a href="http://gratimax.github.io/search-gulp-plugins/">плагинов</a>:</p>
<pre>$ npm install gulp-livereload gulp-imagemin gulp-uglify gulp-concat</pre>
<h2></h2>
<h2>Создание конфигурационного файла</h2>
<p>Для <strong>gulp</strong> конфигурационным файлом является <strong>gulpfile.js</strong>.</p>
<p>Для начала можем создать этот файл со следующим содержимым:</p>
<pre>var gulp = require('gulp');

gulp.task('default', function(){
  // place code for your default task here
});</pre>
<p>и запустить, выполнив команду:</p>
<pre>$ gulp
[gulp] Using file .../gulpfile.js
[gulp] Working directory changed to ...
[gulp] Running 'default'...
[gulp] Finished 'default' in 58 μs</pre>
<p>Принцип вызова тасков из командной строки полностью идентичен <strong>Grunt.js</strong>.</p>
<p>Инициализация/подключение <strong>плагинов</strong>:</p>
<pre>var livereload = require('gulp-livereload'),
    uglify = require('gulp-uglify'),
    concat = require('gulp-concat'),
    connect = require('connect');</pre>
<p>&nbsp;</p>
<h2>Пишем свои задания</h2>
<p>Методы <strong>gulp</strong>, которые могут понадобиться при создании таска:</p>
<table>
<tbody>
<tr>
<th>Метод</th>
<th>Синтаксис</th>
<th>ПримеР</th>
</tr>
<tr>
<td>gulp.<strong>task</strong></td>
<td> gulp.task(name[, deps], fn)</td>
<td>
<pre>gulp.task('do-log',
  function(){console.log('Hello!')
});</pre>
<pre>gulp.task('test', ['do-log']);</pre>
</td>
</tr>
<tr>
<td>gulp.<strong>src</strong></td>
<td> gulp.src(globs[, options])</td>
<td>
<pre>gulp.src('./gulpfile.js')</pre>
</td>
</tr>
<tr>
<td>gulp.<strong>dest</strong></td>
<td> gulp.dest(path)</td>
<td>
<pre>gulp.dest('main.min.css')</pre>
</td>
</tr>
<tr>
<td>gulp.<strong>watch</strong></td>
<td> gulp.watch(glob [, opts], tasks)<br />
or gulp.watch(glob [, opts, cb])</td>
<td>
<pre>var watcher = gulp.watch('js/**/*.js',
             ['uglify','reload']);
watcher.on('change', function(event){
  console.log(event.path+' -&gt; '+event.type);
});</pre>
<pre>gulp.watch('gulpfile.js', function(changes){
console.log(changes) });</pre>
</td>
</tr>
<tr>
<td>gulp.<strong>run</strong></td>
<td> gulp.run(task)</td>
<td>
<pre> gulp.run('subtask')</pre>
</td>
</tr>
</tbody>
</table>
<p>Если собрать все методы в одном примере получим:</p>
<pre>var gulp = require('gulp'),
    jshint = require('gulp-jshint');

gulp.task('jshint', function() {
  gulp.src('./gulpfile.js')
    .pipe(jshint())
    .pipe(jshint.reporter('default'));
});

gulp.task('do-log', function(){
	gulp.watch('*.js', function(changes){
		console.log(changes);
		gulp.run('jshint');
	});
});

gulp.task('start', ['do-log']);</pre>
<p>&#8211; при изменении любого javascript файла (*.js) &#8211; выводим изменения в консоль и запускаем <strong>jshint</strong>-задание.</p>
<p>Вы уже вероятно обратили внимание что вся последовательность действий связанна через <strong>pipe</strong>-метод передающий по цепочке поток данных (<strong>stream</strong>). Концепция взята из <a href="https://github.com/substack/stream-handbook">node.js стримов</a>.</p>
<p>С <strong>gulp</strong> можно прекрасно работать и не понимая, что происходит внутри <strong>pipe</strong>, но если вы уже перешли на следующий уровень и хотите &#8220;вклиниться в поток&#8221; либо написать свой <strong>плагин</strong>, то думаю вам может помочь разобраться этот пример:</p>
<pre>function myPlugin(){
  var stream = through.obj(function (file, enc, callback) {
    console.log(file, enc, callback);
    this.push(file);
    return callback();
  });

  return stream;
}
var through = require('through2');
gulp.task('jshint', function() {
  gulp.src('./gulpfile.js')
  .pipe(myPlugin())
   .pipe(jshint())
   .pipe(jshint.reporter('default'));
});</pre>
<p>Методом <strong>myPlugin</strong> мы вклиниваемся в поток выполнения при этом не нарушая его: возвращаем <strong>stream</strong>. Вместо</p>
<pre>console.log(file, enc, callback);</pre>
<p>может быть ваш код по изменению контента.</p>
<h2>Запуск локального сервера</h2>
<p>так же делается довольно просто</p>
<pre>var connect = require('gulp-connect');
gulp.task('server', function() {
    connect
        .use(connect.static('./public'))
        .listen('3000');
});</pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Материалы, которые вдохновляли на пост:</p>
<ul>
<li><a href="https://laracasts.com/lessons/gulp-this">Gulp This</a></li>
<li><a href="http://habrahabr.ru/post/208890/">GulpJS — фантастически быстрый сборщик проектов</a></li>
<li><a href="http://markdalgleish.github.io/presentation-build-wars-gulp-vs-grunt/">Build Wars</a></li>
<li><a href="http://www.sitepoint.com/introduction-gulp-js/">An Introduction to Gulp.js</a></li>
<li><a title="http://tooling.github.io/" href="http://tooling.github.io/book-of-modern-frontend-tooling/build-systems/gulp/writing-tasks.html">Writing Tasks</a></li>
</ul>
]]></content:encoded>
					
					<wfw:commentRss>https://stepansuvorov.com/blog/2014/03/gulp/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>grunt-notify</title>
		<link>https://stepansuvorov.com/blog/2014/03/grunt-notify/</link>
					<comments>https://stepansuvorov.com/blog/2014/03/grunt-notify/#respond</comments>
		
		<dc:creator><![CDATA[Stepan]]></dc:creator>
		<pubDate>Sat, 01 Mar 2014 22:02:16 +0000</pubDate>
				<category><![CDATA[Рекомендую]]></category>
		<category><![CDATA[grunt]]></category>
		<category><![CDATA[grunt-notify]]></category>
		<category><![CDATA[javascript]]></category>
		<guid isPermaLink="false">http://stepansuvorov.com/blog/?p=1516</guid>

					<description><![CDATA[grunt-notify &#8211; pretty useful grunt plugin that provides the adapter to notification-manager for your custom events. For example: you are doing TDD &#8211; it could inform you when tests-status switches from FAIL to SUCCESS or back. It is supported by all operational &#8230; <a href="https://stepansuvorov.com/blog/2014/03/grunt-notify/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
										<content:encoded><![CDATA[<p><img decoding="async" loading="lazy" class="alignnone size-medium wp-image-1517" title="grunt-notify-screen" src="https://stepansuvorov.com/blog/wp-content/uploads/2014/03/4e63bf88-0814-11e3-8b57-e2f5f4c2e1c1-300x75.png" alt="" width="300" height="75" srcset="https://stepansuvorov.com/blog/wp-content/uploads/2014/03/4e63bf88-0814-11e3-8b57-e2f5f4c2e1c1-300x75.png 300w, https://stepansuvorov.com/blog/wp-content/uploads/2014/03/4e63bf88-0814-11e3-8b57-e2f5f4c2e1c1.png 320w" sizes="(max-width: 300px) 100vw, 300px" /></p>
<p><a href="https://github.com/dylang/grunt-notify">grunt-notify</a> &#8211; pretty useful <strong>grunt</strong> plugin that provides the adapter to <strong>notification-manager</strong> for your custom events. For example: you are doing TDD &#8211; it could inform you when tests-status switches from FAIL to SUCCESS or back. It is supported by all operational systems.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://stepansuvorov.com/blog/2014/03/grunt-notify/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>git hook: Не пускаем в репозиторий ошибки</title>
		<link>https://stepansuvorov.com/blog/2013/01/git-hook/</link>
					<comments>https://stepansuvorov.com/blog/2013/01/git-hook/#comments</comments>
		
		<dc:creator><![CDATA[Stepan]]></dc:creator>
		<pubDate>Wed, 02 Jan 2013 09:54:21 +0000</pubDate>
				<category><![CDATA[Хочу сделать мир лучше]]></category>
		<category><![CDATA[git]]></category>
		<category><![CDATA[grunt]]></category>
		<category><![CDATA[hook]]></category>
		<guid isPermaLink="false">http://stepansuvorov.com/blog/?p=733</guid>

					<description><![CDATA[Настраивая систему разворачивания проекта с репозитория, мы задумались над вопросом чистоты кода репозитория, ибо тесты на самом сервере &#8211; это хорошо, но в системе контроля версий также совсем не помешает держать рабочий код, особенно в &#8220;стабильной&#8221; ветке. Как вариант решения: &#8230; <a href="https://stepansuvorov.com/blog/2013/01/git-hook/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
										<content:encoded><![CDATA[<p><img decoding="async" loading="lazy" class="alignnone size-full wp-image-736" title="stop_errors" src="https://stepansuvorov.com/blog/wp-content/uploads/2012/11/stop_errors.png" alt="" width="128" height="128" /></p>
<p>Настраивая систему разворачивания проекта с репозитория, мы задумались над вопросом чистоты кода репозитория, ибо тесты на самом сервере &#8211; это хорошо, но в системе контроля версий также совсем не помешает держать рабочий код, особенно в &#8220;стабильной&#8221; ветке.</p>
<p>Как вариант решения:  сделать <strong>git-hook</strong>, который бы проверял каждый <strong>push</strong> на репозиторий и не давал заливать &#8220;плохой&#8221; код. (Под &#8220;плохой&#8221; мы будем понимать код, который не прошел юнит-тестов либо валидации JSHint)</p>
<p><span id="more-733"></span></p>
<p>О самом  <a href="http://git-scm.com/book/ru/%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-Git-%D0%9F%D0%B5%D1%80%D0%B5%D1%85%D0%B2%D0%B0%D1%82%D1%87%D0%B8%D0%BA%D0%B8-%D0%B2-Git">git hook</a> можно почитать подробно на официальном сайте. Расскажу только некоторые детали реализации.</p>
<p>Все хуки лежат в директории <strong>./git/hooks/</strong>. Там же есть уже <strong>готовые примеры</strong> реализованные на shell-скрипте(с расширением <em>.sample</em>).</p>
<p>Список возможных действий, на которые можно повесить обработчик:</p>
<ul>
<li>applypatch-msg</li>
<li>post-commit</li>
<li>post-update</li>
<li>pre-commit</li>
<li>update</li>
<li>commit-msg</li>
<li>post-receive</li>
<li>pre-applypatch</li>
<li>pre-rebase</li>
</ul>
<p>&#8211; подробное описание можно посмотреть <a href="http://www.kernel.org/pub/software/scm/git/docs/githooks.html">тут</a>.</p>
<p>Все перехватчики(hooks) можно разделить по месту их выполнения на клиентские и серверные. В нашем случае мы можем проверять код как на стороне клиента перед отправкой, так и на стороне сервера после получения. В первом случае решение будет менее строгим, т.к. позволит разработчику отключить или изменить его в случае чего. Для этого создаем файл pre-commit, где будет описание действия нашего перехватчика.</p>
<p>Теперь стоит подумать как лучше реализовать код перехватчика. Сначала была мысль написать shell-скрипт, но потом мы вспомнили о <a href="https://stepansuvorov.com/blog/2012/10/%D1%81%D0%B1%D0%BE%D1%80%D0%BA%D0%B0-javascript-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%BE%D0%B2-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-grunt/">grunt</a>, который уже прекрасно работал с проектом, и просто добавили еще одно задание(task) в него &#8211; <em>pre-commit-test</em>, в котором описали все необходимые проверки. Осталось только вызывать сборщик из hook-скрипта. Вот весь код:</p>
<pre>#!/bin/sh

GRUNTJS_DIR='/path_to_project/project_dir'
GRUNT_CMD=grunt
cd $GRUNTJS_DIR
$GRUNT_CMD pre-commit-test
EXIT_CODE=$?
[ $EXIT_CODE -gt 0 ] &amp;&amp; echo &amp;&amp; echo validation fail! &amp;&amp; echo
exit $EXIT_CODE</pre>
<p>Немного комментариев:</p>
<pre>GRUNT_CMD=grunt</pre>
<p>пусть к команде grunt(в случае, если она не глобальная)</p>
<pre>[ $EXIT_CODE -gt 0 ]</pre>
<p>проверяем выдал ли что-то валидатор и в случае чего &#8211; прерываем выполнение.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://stepansuvorov.com/blog/2013/01/git-hook/feed/</wfw:commentRss>
			<slash:comments>1</slash:comments>
		
		
			</item>
		<item>
		<title>Сборка javascript проектов с помощью Grunt</title>
		<link>https://stepansuvorov.com/blog/2012/10/%d1%81%d0%b1%d0%be%d1%80%d0%ba%d0%b0-javascript-%d0%bf%d1%80%d0%be%d0%b5%d0%ba%d1%82%d0%be%d0%b2-%d1%81-%d0%bf%d0%be%d0%bc%d0%be%d1%89%d1%8c%d1%8e-grunt/</link>
					<comments>https://stepansuvorov.com/blog/2012/10/%d1%81%d0%b1%d0%be%d1%80%d0%ba%d0%b0-javascript-%d0%bf%d1%80%d0%be%d0%b5%d0%ba%d1%82%d0%be%d0%b2-%d1%81-%d0%bf%d0%be%d0%bc%d0%be%d1%89%d1%8c%d1%8e-grunt/#comments</comments>
		
		<dc:creator><![CDATA[Stepan]]></dc:creator>
		<pubDate>Tue, 30 Oct 2012 13:53:03 +0000</pubDate>
				<category><![CDATA[Хочу сделать мир лучше]]></category>
		<category><![CDATA[grunt]]></category>
		<category><![CDATA[javascript]]></category>
		<category><![CDATA[node.js]]></category>
		<guid isPermaLink="false">http://stepansuvorov.com/blog/?p=711</guid>

					<description><![CDATA[Grunt &#8211; инструмент для сборки JavaScript проектов из командной строки. Молодой (зарелизился в январе 2012) и активно развивающийся(на данный момент для него написано уже 188 плагинов). Благодаря тому, что grunt имеет готовый npm-пакет для node.js,  установка очень простая: $ npm &#8230; <a href="https://stepansuvorov.com/blog/2012/10/%d1%81%d0%b1%d0%be%d1%80%d0%ba%d0%b0-javascript-%d0%bf%d1%80%d0%be%d0%b5%d0%ba%d1%82%d0%be%d0%b2-%d1%81-%d0%bf%d0%be%d0%bc%d0%be%d1%89%d1%8c%d1%8e-grunt/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
										<content:encoded><![CDATA[<p><img decoding="async" loading="lazy" class="alignnone size-medium wp-image-712" title="grunt_logo" src="https://stepansuvorov.com/blog/wp-content/uploads/2012/10/grunt_logo-300x300.png" alt="" width="300" height="300" srcset="https://stepansuvorov.com/blog/wp-content/uploads/2012/10/grunt_logo-300x300.png 300w, https://stepansuvorov.com/blog/wp-content/uploads/2012/10/grunt_logo-150x150.png 150w, https://stepansuvorov.com/blog/wp-content/uploads/2012/10/grunt_logo.png 512w" sizes="(max-width: 300px) 100vw, 300px" /></p>
<p><a href="http://gruntjs.com/">Grunt</a> &#8211; инструмент для сборки JavaScript проектов из командной строки. Молодой (зарелизился в январе 2012) и активно развивающийся(на данный момент для него написано уже 188 плагинов).</p>
<p><span id="more-711"></span>Благодаря тому, что <strong>grunt</strong> имеет готовый npm-пакет для node.js,  установка очень простая:</p>
<pre>$ npm install grunt -g</pre>
<p>Ставим <strong>grunt</strong> глобально, после чего нам доступна команда из консоли:</p>
<pre>$ grunt --version
grunt v0.3.17</pre>
<p>Далее необходимо <strong>инициализировать проект</strong>, для этого у нас есть команда grunt init:TEMPLATE, где TEMPLATE &#8211; один из шаблонов:</p>
<ul>
<li>commonjs</li>
<li>jquery</li>
<li>node</li>
<li>gruntfile &#8211; только главный файл</li>
<li>gruntplugin</li>
</ul>
<p>Перейдем в директорию где мы хотим создать grunt проект и выполним:</p>
<pre>$ grunt init:jquery</pre>
<p>после чего должно выдать серию вопросов о проекте(title, description, git-url&#8230;). После успешного прохождения этого квеста в выбранной директории появятся файлы сборщика.</p>
<p>Установим также <a title="статья по phantomjs" href="https://stepansuvorov.com/blog/2012/09/%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%B5%D0%BC-%D1%8E%D0%BD%D0%B8%D1%82-%D1%82%D0%B5%D1%81%D1%82%D1%8B-%D1%81-phantomjs/">PhantomJs</a>, наличие которого предполагает grunt.</p>
<p>После чего можем смело запускать сборщик на выполнение:</p>
<pre>$ grunt
Running "lint:files" (lint) task
Lint free.

Running "qunit:files" (qunit) task
Testing testproject.html....OK
&gt;&gt; 4 assertions passed (23ms)

Running "concat:dist" (concat) task
File "dist/testproject.js" created.

Running "min:dist" (min) task
File "dist/testproject.min.js" created.
Uncompressed size: 467 bytes.
Compressed size: 229 bytes gzipped (324 bytes minified).

Done, without errors.</pre>
<p>&#8211; вот так вот он работает: проверил код(JSHint), запустил тесты(QUnit), соединил и сжал  файлы.</p>
<p>Чтобы рассмотреть инструкции по конфигурированию сборщика, проинициализируем новый проект:</p>
<pre>$ grunt init:gruntfile</pre>
<p>Он создаст только заготовку для главного файла(grunt.js). Откроем ее и посмотрим что внутри.</p>
<p>Начнем разбор с конца файла:</p>
<pre>grunt.registerTask('default', 'lint qunit concat min');</pre>
<p>Эта строчка говорит grunt какие задачи будут выполнены по умолчанию(т.е. запустив команду без параметров). Тут мы можем добавить свои варианты:</p>
<pre>grunt.registerTask('prod', 'lint qunit concat min');
grunt.registerTask('test', 'lint qunit');</pre>
<p>Возможные варианты заданий:</p>
<ul>
<li>concat &#8211; конкатенация файлов</li>
<li>init &#8211; Generate project scaffolding from a predefined template.</li>
<li>lint &#8211; валидация файлов с помощью  <a href="http://www.jshint.com/">JSHint</a>.</li>
<li>min &#8211; сжатие файлов с <a href="https://github.com/mishoo/UglifyJS/">UglifyJS</a>.</li>
<li>qunit &#8211; Запуск <a href="http://docs.jquery.com/QUnit">QUnit</a> юнит тестов на <a href="http://www.phantomjs.org/">PhantomJS</a>.</li>
<li>server &#8211; запускает статический веб сервер.</li>
<li>test &#8211; запуск юнит тестов на <a href="https://github.com/caolan/nodeunit">nodeunit</a>.</li>
<li>watch &#8211; запуск заранее определенных заданий, для файлов из списка.</li>
</ul>
<p>Ну а теперь последовательно по секциям конфига(по сути конфигурация для каждого задания):</p>
<pre>meta - описание проекта, вспомогательная информация
lint/qunit/test/concat/min - список фалов, 
которые нужно отвалидировать(JSHint)/протестировать(qUnit)/протестировать(nodeUnit)/объединить/сжать(UglifyJS)
watch - список файлов и команды, которые необходимо выполнить, в случае изменения содержания файла
jshint - конфигурация JSHint
uglify - специфические настройки UglifyJS
server - пока не понятно зачем</pre>
<p>Для каждой опции, где мы указываем список файлов существуют 2 подсекции: files и src. По умолчанию задание выполняется с командой files, но если мы хоти выполнить со списком файлов src, тогда стоит уточнить:</p>
<div>
<pre>grunt.registerTask(<code>'build_src'</code><code>, </code><code>'lint:src qunit:src concat:src min:src'</code><code>);</code></pre>
</div>
<p>Если встроенных заданий не хватает, можно писать свои и мотом подключать их с помощью методов:</p>
<pre>grunt.loadTasks(ПУТЬ_К_ДИРЕКТОРИИ_С_ЗАДАНИЕМ);
<code>grunt.loadNpmTasks(ИМЯ_ПЛАГИНА);</code></pre>
<p>&#8211; второй вариант для дополнительных задач установленных через <strong>npm</strong>. Вот хорошая <a href="https://github.com/gruntjs/grunt-contrib">страничка</a>, на которой перечислены самые распространенные варианты. Попробуем поставить <strong>requirejs</strong>:</p>
<pre>npm install grunt-contrib-requirejs</pre>
<p>и подключим в файл конфигурации:</p>
<pre>grunt.loadNpmTasks("requirejs");</pre>
<p>Внимание! тут есть специфика: модули установленные через npm будут подхватываться только если установлены в директорию c grunt. Подробно проблема описана вот <a href="https://github.com/gruntjs/grunt/issues/232">тут</a>.</p>
<p>Из основного это все.</p>
<h2></h2>
]]></content:encoded>
					
					<wfw:commentRss>https://stepansuvorov.com/blog/2012/10/%d1%81%d0%b1%d0%be%d1%80%d0%ba%d0%b0-javascript-%d0%bf%d1%80%d0%be%d0%b5%d0%ba%d1%82%d0%be%d0%b2-%d1%81-%d0%bf%d0%be%d0%bc%d0%be%d1%89%d1%8c%d1%8e-grunt/feed/</wfw:commentRss>
			<slash:comments>3</slash:comments>
		
		
			</item>
	</channel>
</rss>
