<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>ui-router &#8211; Stepan Suvorov Blog</title>
	<atom:link href="https://stepansuvorov.com/blog/tag/ui-router/feed/" rel="self" type="application/rss+xml" />
	<link>https://stepansuvorov.com/blog</link>
	<description>Release 2.0</description>
	<lastBuildDate>Thu, 02 Mar 2017 20:22:14 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=6.3.1</generator>
	<item>
		<title>ui-router: Deprecated events and hooks</title>
		<link>https://stepansuvorov.com/blog/2016/07/ui-router-deprecated-events-and-hooks/</link>
					<comments>https://stepansuvorov.com/blog/2016/07/ui-router-deprecated-events-and-hooks/#comments</comments>
		
		<dc:creator><![CDATA[Stepan]]></dc:creator>
		<pubDate>Thu, 28 Jul 2016 19:28:50 +0000</pubDate>
				<category><![CDATA[Хочу сделать мир лучше]]></category>
		<category><![CDATA[AngularJs]]></category>
		<category><![CDATA[javascript]]></category>
		<category><![CDATA[ui-router]]></category>
		<guid isPermaLink="false">http://stepansuvorov.com/blog/?p=3093</guid>

					<description><![CDATA[If you are using latest version of ui-router (now it&#8217;s 1.0.0-alpha) you probably already noticed that there are no events that we all got used to: $stateChangeCancel,  $stateChangeError, $stateChangeStart, $stateChangeSuccess, $stateNotFound. All of them are deprecated in 1.0.0-alpha.3 and you can not use them &#8230; <a href="https://stepansuvorov.com/blog/2016/07/ui-router-deprecated-events-and-hooks/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
										<content:encoded><![CDATA[<p>If you are using latest version of <a href="https://github.com/angular-ui/ui-router">ui-router</a> (now it&#8217;s <strong>1.0.0-alpha</strong>) you probably already noticed that there are no events that we all got used to: <strong>$stateChangeCancel</strong>,  <strong>$stateChangeError</strong>, <strong>$stateChangeStart</strong>, <strong>$stateChangeSuccess</strong>, <strong>$stateNotFound</strong>. All of them are deprecated in 1.0.0-alpha.3 and you can not use them anymore in 1.0.0-alpha.5.</p>
<p>If you want to move to new version of ui-router you should make such changes:</p>
<p><span id="more-3093"></span></p>
<h2>$stateChangeCancel</h2>
<p>It was an event that was thrown <a href="https://github.com/angular-ui/ui-router/commit/ecefb75">when somebody called &#8220;event.preventDefault()&#8221;</a>. Now everything is controlled by transitions so no chance to get such event.</p>
<h2>$stateChangeError</h2>
<p>old code</p>
<p>[javascript]<br />
$rootScope.$on(&#8216;$stateChangeError&#8217;, function(event, toState) {<br />
    //some code to handle the error<br />
})<br />
[/javascript]</p>
<p>new code</p>
<p>[javascript]<br />
$transitions.onError({ to: &#8216;stateName&#8217; }, function($error$) {<br />
  console.log($error$);<br />
}<br />
[/javascript]</p>
<p>in progress</p>
<h2>$stateChangeStart</h2>
<p>old code</p>
<p>[javascript]<br />
$rootScope.$on(&#8216;$stateChangeStart&#8217;, function(event, toState) {<br />
    event.preventDefault();<br />
})<br />
[/javascript]</p>
<p>new code</p>
<p>[javascript]<br />
$transitions.onEnter({ to: &#8216;stateName&#8217; }, function($state$, $transition$) {<br />
  return $q.reject()<br />
}<br />
[/javascript]</p>
<h2>$stateChangeSuccess</h2>
<p>old code</p>
<p>[javascript]<br />
$rootScope.$on(&#8216;$stateChangeSuccess&#8217;, function(event) {})<br />
[/javascript]</p>
<p>new code</p>
<p>[javascript]<br />
$transitions.onSuccess({}, () =&gt; {});<br />
[/javascript]</p>
<h2>$stateNotFound</h2>
<p>old code</p>
<p>[javascript]<br />
$rootScope.$on(&#8216;$stateNotFound&#8217;, function(event) {})<br />
[/javascript]</p>
<p>new code</p>
<p>[javascript]<br />
$stateProvider.onInvalid(($to$, $from$) =&gt; {})<br />
[/javascript]</p>
<p>&nbsp;</p>
<p><a href="http://plnkr.co/edit/ahs15IQI866ZwrvxvIMe?p=preview">Sandbox</a> to play with all examples.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://stepansuvorov.com/blog/2016/07/ui-router-deprecated-events-and-hooks/feed/</wfw:commentRss>
			<slash:comments>4</slash:comments>
		
		
			</item>
		<item>
		<title>ui-router: Default child for abstract state</title>
		<link>https://stepansuvorov.com/blog/2016/05/ui-router-default-child-for-abstract-state/</link>
					<comments>https://stepansuvorov.com/blog/2016/05/ui-router-default-child-for-abstract-state/#comments</comments>
		
		<dc:creator><![CDATA[Stepan]]></dc:creator>
		<pubDate>Sat, 28 May 2016 15:08:06 +0000</pubDate>
				<category><![CDATA[Хочу сделать мир лучше]]></category>
		<category><![CDATA[AngularJs]]></category>
		<category><![CDATA[javascript]]></category>
		<category><![CDATA[ui-router]]></category>
		<guid isPermaLink="false">http://stepansuvorov.com/blog/?p=3078</guid>

					<description><![CDATA[In version 1.0.0alpha0 they finally make it possible! Child for abstract states? No! But now at least it&#8217;s possible to create own fix for it due to new $transitionsProvider, in which you could define onBefore hook. You can change the behaviour depends on &#8230; <a href="https://stepansuvorov.com/blog/2016/05/ui-router-default-child-for-abstract-state/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
										<content:encoded><![CDATA[<p>In version <strong>1.0.0alpha0</strong> they finally make it possible! Child for abstract states? No! But now at least it&#8217;s possible to create own fix for it due to new <strong>$transitionsProvider</strong>, in which you could define <strong>onBefore</strong> hook. You can change the behaviour depends on state options. Let&#8217;s use &#8220;abstract&#8221; property that is boolean and extend it: to make it possible to add child state here:</p>
<p>[javascript]<br />
$transitionsProvider.onBefore({<br />
        to: state =&gt; !!state.abstract<br />
      }, ($transition$, $state) =&gt; {<br />
        if (angular.isString($transition.to().abstract)) {<br />
          return $state.target($transition.to().abstract);<br />
        }<br />
      });<br />
[/javascript]</p>
<p>basically if abstract param is a string we set it like a target. Example of use:</p>
<p>[javascript]<br />
 .state({<br />
          name: &#8216;abstract2&#8217;,<br />
          url: &#8216;/abstract2&#8217;,<br />
          abstract: &#8216;abstract2.foo&#8217;, // redirect to &#8216;abstract2.foo&#8217;<br />
          template: &#8216;abstract2&#8217;<br />
        })<br />
[/javascript]</p>
<p><span id="more-3078"></span></p>
<p>to cover more complex case we could set it like a function:</p>
<p>[javascript]<br />
 $transitionsProvider.onBefore({<br />
        to: state =&gt; !!state.abstract<br />
      }, ($transition$, $state, $injector) =&gt; {<br />
        if (angular.isFunction($transition.to().abstract)) {<br />
          return $state.target($injector.invoke($transition.to().abstract))<br />
        }<br />
      });<br />
[/javascript]</p>
<p>and an example for an abstract state with child that is defined by function:</p>
<p>[javascript]<br />
   .state({<br />
          name: &#8216;abstract3&#8217;,<br />
          url: &#8216;/abstract3&#8217;,<br />
          abstract: function() {<br />
            return &#8216;abstract3.foo&#8217;<br />
          }, // Function redirect<br />
          template: &#8216;abstract3&#8217;<br />
        })<br />
[/javascript]</p>
<p>All code for experiments is available on <a href="http://plnkr.co/edit/vOJlRv9V7fX9G8TNqfKf?p=preview">plunker</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://stepansuvorov.com/blog/2016/05/ui-router-default-child-for-abstract-state/feed/</wfw:commentRss>
			<slash:comments>1</slash:comments>
		
		
			</item>
		<item>
		<title>How to catch Angular ui-router resolve errors</title>
		<link>https://stepansuvorov.com/blog/2015/07/how-to-catch-angular-ui-router-resolve-errors/</link>
					<comments>https://stepansuvorov.com/blog/2015/07/how-to-catch-angular-ui-router-resolve-errors/#comments</comments>
		
		<dc:creator><![CDATA[Stepan]]></dc:creator>
		<pubDate>Thu, 09 Jul 2015 10:04:23 +0000</pubDate>
				<category><![CDATA[Хочу сделать мир лучше]]></category>
		<category><![CDATA[AngularJs]]></category>
		<category><![CDATA[debug]]></category>
		<category><![CDATA[javascript]]></category>
		<category><![CDATA[ui-router]]></category>
		<guid isPermaLink="false">http://stepansuvorov.com/blog/?p=2737</guid>

					<description><![CDATA[It&#8217;s more than annoying to have just a blank page and no errors in console when your issue is inside ui-router resolve. Finally I found a pretty nice solution, don&#8217;t know why it&#8217;s not provided &#8220;from the box&#8221;. In case &#8230; <a href="https://stepansuvorov.com/blog/2015/07/how-to-catch-angular-ui-router-resolve-errors/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
										<content:encoded><![CDATA[<p>It&#8217;s more than annoying to have just a blank page and no errors in console when your issue is inside <strong>ui-router resolve</strong>. Finally I found a pretty nice solution, don&#8217;t know why it&#8217;s not provided &#8220;from the box&#8221;. In case of error ui-router sends specific event <strong><a href="https://github.com/angular-ui/ui-router/wiki#state-change-events">$stateChangeError</a></strong> that we could listen for:</p>
<p>[javascript]<br />
$rootScope.$on(&#8216;$stateChangeError&#8217;, function(event, toState, toParams, fromState, fromParams, error){<br />
  console.error(error);<br />
});<br />
[/javascript]</p>
<p>and now wow! we have an exact error in console and no need to guess what&#8217;s wrong with your code anymore.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://stepansuvorov.com/blog/2015/07/how-to-catch-angular-ui-router-resolve-errors/feed/</wfw:commentRss>
			<slash:comments>2</slash:comments>
		
		
			</item>
		<item>
		<title>ui-router debug snippet</title>
		<link>https://stepansuvorov.com/blog/2015/04/ui-router-debug/</link>
					<comments>https://stepansuvorov.com/blog/2015/04/ui-router-debug/#respond</comments>
		
		<dc:creator><![CDATA[Stepan]]></dc:creator>
		<pubDate>Mon, 13 Apr 2015 14:41:01 +0000</pubDate>
				<category><![CDATA[Хочу сделать мир лучше]]></category>
		<category><![CDATA[AngularJs]]></category>
		<category><![CDATA[debug]]></category>
		<category><![CDATA[ui-router]]></category>
		<guid isPermaLink="false">http://stepansuvorov.com/blog/?p=2531</guid>

					<description><![CDATA[found nice code snippet that could help you to debug ui-router issues by loggin router events in console: [javascript] // Credits: Adam`s answer in http://stackoverflow.com/a/20786262/69362 var $rootScope = angular.element(document.querySelectorAll(&#8216;[ui-view]&#8217;)[0]).injector().get(&#8216;$rootScope&#8217;); $rootScope.$on(&#8216;$stateChangeStart&#8217;,function(event, toState, toParams, fromState, fromParams){ console.log(&#8216;$stateChangeStart to &#8216;+toState.to+&#8217;- fired when the transition begins. &#8230; <a href="https://stepansuvorov.com/blog/2015/04/ui-router-debug/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
										<content:encoded><![CDATA[<p>found nice code snippet that could help you to debug ui-router issues by loggin router events in console:</p>
<p>[javascript]<br />
// Credits: Adam`s answer in http://stackoverflow.com/a/20786262/69362<br />
var $rootScope = angular.element(document.querySelectorAll(&#8216;[ui-view]&#8217;)[0]).injector().get(&#8216;$rootScope&#8217;);</p>
<p>$rootScope.$on(&#8216;$stateChangeStart&#8217;,function(event, toState, toParams, fromState, fromParams){<br />
  console.log(&#8216;$stateChangeStart to &#8216;+toState.to+&#8217;- fired when the transition begins. toState,toParams : \n&#8217;,toState, toParams);<br />
});</p>
<p>$rootScope.$on(&#8216;$stateChangeError&#8217;,function(event, toState, toParams, fromState, fromParams){<br />
  console.log(&#8216;$stateChangeError &#8211; fired when an error occurs during transition.&#8217;);<br />
  console.log(arguments);<br />
});</p>
<p>$rootScope.$on(&#8216;$stateChangeSuccess&#8217;,function(event, toState, toParams, fromState, fromParams){<br />
  console.log(&#8216;$stateChangeSuccess to &#8216;+toState.name+&#8217;- fired once the state transition is complete.&#8217;);<br />
});</p>
<p>$rootScope.$on(&#8216;$viewContentLoaded&#8217;,function(event){<br />
  console.log(&#8216;$viewContentLoaded &#8211; fired after dom rendered&#8217;,event);<br />
});</p>
<p>$rootScope.$on(&#8216;$stateNotFound&#8217;,function(event, unfoundState, fromState, fromParams){<br />
  console.log(&#8216;$stateNotFound &#8216;+unfoundState.to+&#8217;  &#8211; fired when a state cannot be found by its name.&#8217;);<br />
  console.log(unfoundState, fromState, fromParams);<br />
});<br />
[/javascript]</p>
<p>if you have you Angular app root on html element you can simply use:</p>
<p>[javascript]<br />
var $rootScope = angular.element(document).scope();<br />
[/javascript]</p>
<p>code is placed <a title="gist" href="https://gist.github.com/stevermeister/aab6dcceff81b1449855">here</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://stepansuvorov.com/blog/2015/04/ui-router-debug/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Авторизация AngularJS. Right way.</title>
		<link>https://stepansuvorov.com/blog/2014/08/%d0%b0%d0%b2%d1%82%d0%be%d1%80%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f-angularjs-right-way/</link>
					<comments>https://stepansuvorov.com/blog/2014/08/%d0%b0%d0%b2%d1%82%d0%be%d1%80%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f-angularjs-right-way/#comments</comments>
		
		<dc:creator><![CDATA[Stepan]]></dc:creator>
		<pubDate>Fri, 15 Aug 2014 18:47:29 +0000</pubDate>
				<category><![CDATA[Хочу сделать мир лучше]]></category>
		<category><![CDATA[AngularJs]]></category>
		<category><![CDATA[auth]]></category>
		<category><![CDATA[javascript]]></category>
		<category><![CDATA[ui-router]]></category>
		<guid isPermaLink="false">http://stepansuvorov.com/blog/?p=1622</guid>

					<description><![CDATA[Изучив кучу инструкций по сборке различных моделей велосипедов я таки собрал свой. Будет хорошо, если пост поможет сэкономить кому-то время на конструирование. UPD: Статья обновлена и дополнена 2017-02-21 Отдельный модуль Так как я сторонник модульного подхода и считаю, что именно &#8230; <a href="https://stepansuvorov.com/blog/2014/08/%d0%b0%d0%b2%d1%82%d0%be%d1%80%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f-angularjs-right-way/">Continue reading <span class="meta-nav">&#8594;</span></a>]]></description>
										<content:encoded><![CDATA[<p><img decoding="async" fetchpriority="high" class="alignnone size-full wp-image-1762" title="angular auth" src="https://stepansuvorov.com/blog/wp-content/uploads/2014/06/imgres.png" alt="" width="218" height="231" /></p>
<p>Изучив кучу инструкций по сборке различных моделей велосипедов я таки собрал свой. Будет хорошо, если пост поможет сэкономить кому-то время на конструирование.</p>
<p><strong>UPD</strong>: Статья обновлена и дополнена <strong>2017-02-21</strong></p>
<p><span id="more-1622"></span></p>
<h1>Отдельный модуль</h1>
<p>Так как я сторонник модульного подхода и считаю, что именно это правильный способ использования <strong>AngualrJS</strong>, то весь функционал связанный с авторизацией я сложил в отдельный модуль <strong>auth</strong>. К нему подключаю модуль управления <a href="https://docs.angularjs.org/api/ngCookies/service/$cookies">кукисами</a> и модуль организации удобной работы с <strong>REST</strong>(<a title="github.com/mgonto/restangular" href="https://github.com/mgonto/restangular">restangular</a>):</p>
<p>[javascript]angular.module(&#8216;auth&#8217;, [&#8216;ngCookies&#8217;, &#8216;restangular&#8217;]);[/javascript]</p>
<h2>Сервис авторизации</h2>
<p>Понятное дело, что какой бы вы самокат не делали, без сервиса не обойтись. Что в нем должно находиться? Делаем REST/token вариант авторизации, поэтому в сервисе будет следующий функционал:</p>
<ul>
<li>авторизация по логину (асинхронная операция: POST запрос и получение/сохранения токена)</li>
<li>авторизация по токену (асинхронная операция: GET запрос и получение информации по пользователю)</li>
<li>проверка статуса (синхронная операция)</li>
<li>логаут (зачистка данных авторизации &#8211; токена)</li>
</ul>
<p>Вот упрощенная версия кода(выкинул обработку ошибок):</p>
<p>[javascript]angular.module(&#8216;auth&#8217;)<br />
  .service(&#8216;AuthService&#8217;, function($cookies, $http, Restangular) {<br />
    &#8216;use strict&#8217;;</p>
<p>    var self = this;<br />
    this.status = {<br />
      authorized: false,<br />
    };</p>
<p>    this.loginByCredentials = function(username, password) {<br />
      return Restangular.all(&#8216;sessions&#8217;).post({ email: username, password: password })<br />
        .then(function(response) {<br />
          return self.loginByToken(response.contents);<br />
        });<br />
    };</p>
<p>    this.loginByToken = function(token) {<br />
      $http.defaults.headers.common[&#8216;X-Token&#8217;] = token;</p>
<p>      return Restangular.all(&#8216;sessions&#8217;).get(token)<br />
        .then(function(response) {<br />
          $cookies.accessToken = token;<br />
          self.status.authorized = true;<br />
          return response;<br />
        });<br />
    };</p>
<p>    this.logout = function() {<br />
      self.status.authorized = false;<br />
      $cookies.accessToken = &#8221;;</p>
<p>      Restangular.all(&#8216;sessions&#8217;).remove();<br />
    };<br />
  });[/javascript]</p>
<p>Приходится подключать <strong>$http</strong> сервис для вот этого хака:</p>
<p>[javascript]$http.defaults.headers.common[&#8216;X-Token&#8217;] = token;[/javascript]</p>
<p>&#8211; по другому в <strong>Restangular</strong> не получается динамически задать хедер, в котором мы хотим отправлять токен авторизации.</p>
<p>(если у вас есть другое решение данной ситуации &#8211; пожалуйста поделитесь)</p>
<h2>Страница авторизации</h2>
<p>Если вы используете стандартный ангуляровский роутер, тут может возникнуть вопрос: Как для авторизации показывать другой лэйаут?</p>
<p>Решение подсказал <a title="olostan.name" href="http://olostan.name/">Валентин Шибанов</a>, который предложил завернуть все содержимое(в том числе <strong>ui-view</strong>) в <strong>ng-if</strong>, который бы в зависимости от того, авторизираван пользователь или нет, показывал бы либо содержимое с меню либо формочку авторизации.</p>
<p>Итого имеем(опять очень упрощенная версия):</p>
<p>[html]<br />
&lt;div ng-if=&quot;isAutorized&quot;&gt;<br />
    &lt;menu&gt;&lt;/menu&gt;<br />
    &lt;ui-view&gt;&lt;/ui-vew&gt;<br />
&lt;div ng-if=&quot;!isAutorized&quot;&gt;<br />
    &lt;login&gt;&lt;/login&gt;<br />
&lt;/div&gt;<br />
[/html]</p>
<h2></h2>
<h2>Плюшки с интерсепторами</h2>
<p>Если переодически пропадает сессия с сервером(таймаут), но клиент остается активным, и вы хотите восстановить сессию без привлечения пользователя, можно посмотреть в сторону <a href="https://stepansuvorov.com/blog/2014/04/angularjs-interceptors-%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80%D1%8B/">интерсепторов</a>. Так же интерсепторы можно использовать для общей обработки ошибок авторизации.</p>
<h2>Момент определения состояния авторизации и ограничение доступа</h2>
<p>Давайте разберемся, в какой момент мы должны/можем проверять состояние авторизации. Все варианты можно условно разбить на 2:</p>
<ul>
<li>ответ API (мы узнали от сервера)</li>
<li>изменение состояния (перешли на другую страничку)
<ul>
<li>событие изменение состояния</li>
<li>резолв конкретного стейта</li>
</ul>
</li>
</ul>
<p>Давайте посмотрим на все случаи.</p>
<h2>Ответ от API и интерсептор для обратки ошибки</h2>
<p>Про интерсепторы можно более подробно почитать <a href="https://stepansuvorov.com/blog/2014/04/angularjs-interceptors-%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80%D1%8B/">тут</a>. Мы с вами реализуем один из них интесептор ошибки ответа:</p>
<p>[javascript]<br />
app.service(&#8216;authRejector&#8217;, function($q) {<br />
    this.responseError = (rejection) =&gt; {<br />
      if (rejection.status === 401) {<br />
        //делаем какие-то действия для пользователя без авторизации<br />
      }</p>
<p>      return $q.reject(rejection);<br />
    };<br />
  });<br />
[/javascript]</p>
<p>и потом подключаем наш интерсептор к остальным:</p>
<p>[javascript]<br />
  app.config(function($httpProvider) {<br />
    $httpProvider.interceptors.push(&#8216;authRejector&#8217;);<br />
  });<br />
[/javascript]</p>
<h2>Изменение стейта</h2>
<p>Навесить хук в событие <strong>ui-router</strong> можно с помощью сервиса <strong>$transitions</strong>:</p>
<p>[javascript]<br />
$transitions.onEnter({ to: &#8216;stateName&#8217; }, function($state$, $transition$) {<br />
  if(!AuthService.status.authorized){<br />
    //делаем какие-то действия для пользователя без авторизации<br />
    return $q.reject()<br />
  }</p>
<p>}<br />
[/javascript]</p>
<h2>Запрет доступа к страница с помощью резолв</h2>
<p>Давайте предлополжим, что у нас есть стейт <strong>users</strong>:</p>
<p>[javascript]<br />
 .state(&#8216;users&#8217;, {})<br />
[/javascript]</p>
<p>к которому мы хотим ограничить доступ. Для этого добавим резолв с использованием все того же сервиса авторизации:</p>
<p>[javascript]<br />
        .state(&#8216;users&#8217;, {<br />
          resolve: {<br />
            auth: function($q, AuthService) {<br />
              if(!AuthService.status.authorized) {<br />
                $q.reject();<br />
                alert(&#8216;Вы должны авторизироваться!&#8217;);<br />
              }<br />
            }<br />
          }<br />
        })<br />
[/javascript]</p>
<h2>Проверка авторизации при переходе на другую страницу</h2>
<p>В<strong> ui-router</strong> мы можем навесить хук на событие перехода на какой либо стейт с помощью сервиса <strong>$transitions</strong>:</p>
<p>[javascript]<br />
$transitions.onEnter({ to: &#8216;stateName&#8217; }, function($state$, $transition$) {<br />
  if(!AuthService.status.authorized){<br />
    //делаем какие-то действия для пользователя без авторизации<br />
    return $q.reject()<br />
  }<br />
}<br />
[/javascript]</p>
<p>Но у приведем сам логин компонент для полноты примера.</p>
<h2>Пример логин компонента</h2>
<p>[javascript]<br />
app.component(&#8216;login&#8217;, {<br />
  controller: function(AuthService){<br />
    this.login = function(login, password)<br />
    AuthService.loginByCredentials(login, password).catch(function(){<br />
      //выводим ошибку авторизации<br />
    });<br />
  }<br />
});<br />
[/javascript]</p>
<p>&nbsp;</p>
]]></content:encoded>
					
					<wfw:commentRss>https://stepansuvorov.com/blog/2014/08/%d0%b0%d0%b2%d1%82%d0%be%d1%80%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f-angularjs-right-way/feed/</wfw:commentRss>
			<slash:comments>20</slash:comments>
		
		
			</item>
	</channel>
</rss>
