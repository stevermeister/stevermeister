{"id":3286,"date":"2017-03-05T12:53:59","date_gmt":"2017-03-05T10:53:59","guid":{"rendered":"http:\/\/stepansuvorov.com\/blog\/?p=3286"},"modified":"2017-03-05T12:53:59","modified_gmt":"2017-03-05T10:53:59","slug":"angular-lazy-loading-and-preloading-strategy","status":"publish","type":"post","link":"https:\/\/stepansuvorov.com\/blog\/2017\/03\/angular-lazy-loading-and-preloading-strategy\/","title":{"rendered":"Angular: Lazy Loading and Preloading strategy"},"content":{"rendered":"<p>Almost all of you know that it&#8217;s possible in <strong>Angular<\/strong> to load modules asynchronously by using <strong>Lazy Loading <\/strong>Router feature, you just need to specify special parameter for the state &#8211; <strong>loadChildren<\/strong>:<\/p>\n<p>[javascript]<br \/>\n{ path: &#8216;lazy&#8217;, loadChildren: &#8216;.\/lazy\/lazy.module#LazyModule&#8217; }<br \/>\n[\/javascript]<\/p>\n<p>and setup child module with <strong>RouterModule.forChild<\/strong> method:<\/p>\n<p>[javascript]<br \/>\nconst routes: Routes = [<br \/>\n  { path: &#8221;, component: AdminComponent }<br \/>\n];<\/p>\n<p>@NgModule({<br \/>\n  imports: [<br \/>\n    CommonModule,<br \/>\n    RouterModule.forChild(routes)<br \/>\n  ],<br \/>\n  declarations: [AdminComponent]<br \/>\n})<br \/>\nexport class LazyModule { }<br \/>\n[\/javascript]<\/p>\n<p>In most cases you are doing so not to load all the modules at once make &#8220;first screen&#8221; appearing quicker. But it&#8217;s not all folks, you also could preload all your lazy modules when your application base is loaded so: you are showing first screen fast and after load other modules in background to show them immediately when it&#8217;s needed. And it&#8217;s really usy to setup: for you main RouterModule you add the property <strong>preloadingStrategy<\/strong>:<\/p>\n<p><!--more--><\/p>\n<p>[javascript]<br \/>\n  imports: [<br \/>\n    CommonModule,<br \/>\n    RouterModule.forRoot(appRoutes, { preloadingStrategy: PreloadAllModules }),<br \/>\n    &#8230;<br \/>\n  ],<\/p>\n<p>[\/javascript]<\/p>\n<p>But even more interesting that you could create your own strategy for loading logic. For example you want to start loading the rest of the modules in 5s after app is loaded:<\/p>\n<p>[javascript]<br \/>\nexport class CustomPreloadingStrategy implements PreloadingStrategy {<br \/>\n    preload(route: Route, fn: () =&gt; Observable&lt;boolean&gt;): Observable&lt;boolean&gt; {<br \/>\n        return Observable.of(true).delay(5000).flatMap( (_: boolean)=&gt; fn());<br \/>\n    }<br \/>\n}<br \/>\n[\/javascript]<\/p>\n<p>and you can also specify which routes should not be preloaded:<\/p>\n<p>[javascript]<br \/>\nexport class CustomPreloadingStrategy implements PreloadingStrategy {<\/p>\n<p>  public preload(route: Route, fn: () =&gt; Observable&lt;boolean&gt;): Observable&lt;boolean&gt; {<br \/>\n    if (route.data &amp;&amp; route.data[&#8216;nopreload&#8217;]) {<br \/>\n      return Observable.of(false);<br \/>\n    }<\/p>\n<p>    return Observable.of(true).delay(5000).flatMap((_: boolean) =&gt; fn());<br \/>\n  }<br \/>\n}<br \/>\n[\/javascript]<\/p>\n","protected":false},"excerpt":{"rendered":"<p>Almost all of you know that it&#8217;s possible in Angular to load modules asynchronously by using Lazy Loading Router feature, you just need to specify special parameter for the state &#8211; loadChildren: [javascript] { path: &#8216;lazy&#8217;, loadChildren: &#8216;.\/lazy\/lazy.module#LazyModule&#8217; } [\/javascript] &hellip; <a href=\"https:\/\/stepansuvorov.com\/blog\/2017\/03\/angular-lazy-loading-and-preloading-strategy\/\">Continue reading <span class=\"meta-nav\">&rarr;<\/span><\/a><\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[4],"tags":[185,464,465,466],"_links":{"self":[{"href":"https:\/\/stepansuvorov.com\/blog\/wp-json\/wp\/v2\/posts\/3286"}],"collection":[{"href":"https:\/\/stepansuvorov.com\/blog\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/stepansuvorov.com\/blog\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/stepansuvorov.com\/blog\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/stepansuvorov.com\/blog\/wp-json\/wp\/v2\/comments?post=3286"}],"version-history":[{"count":1,"href":"https:\/\/stepansuvorov.com\/blog\/wp-json\/wp\/v2\/posts\/3286\/revisions"}],"predecessor-version":[{"id":3287,"href":"https:\/\/stepansuvorov.com\/blog\/wp-json\/wp\/v2\/posts\/3286\/revisions\/3287"}],"wp:attachment":[{"href":"https:\/\/stepansuvorov.com\/blog\/wp-json\/wp\/v2\/media?parent=3286"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/stepansuvorov.com\/blog\/wp-json\/wp\/v2\/categories?post=3286"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/stepansuvorov.com\/blog\/wp-json\/wp\/v2\/tags?post=3286"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}