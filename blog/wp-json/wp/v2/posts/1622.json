{"id":1622,"date":"2014-08-15T18:47:29","date_gmt":"2014-08-15T18:47:29","guid":{"rendered":"http:\/\/stepansuvorov.com\/blog\/?p=1622"},"modified":"2017-03-02T22:22:14","modified_gmt":"2017-03-02T20:22:14","slug":"%d0%b0%d0%b2%d1%82%d0%be%d1%80%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f-angularjs-right-way","status":"publish","type":"post","link":"https:\/\/stepansuvorov.com\/blog\/2014\/08\/%d0%b0%d0%b2%d1%82%d0%be%d1%80%d0%b8%d0%b7%d0%b0%d1%86%d0%b8%d1%8f-angularjs-right-way\/","title":{"rendered":"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f AngularJS. Right way."},"content":{"rendered":"<p><img decoding=\"async\" loading=\"lazy\" class=\"alignnone size-full wp-image-1762\" title=\"angular auth\" src=\"https:\/\/stepansuvorov.com\/blog\/wp-content\/uploads\/2014\/06\/imgres.png\" alt=\"\" width=\"218\" height=\"231\" \/><\/p>\n<p>\u0418\u0437\u0443\u0447\u0438\u0432 \u043a\u0443\u0447\u0443 \u0438\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u0439 \u043f\u043e \u0441\u0431\u043e\u0440\u043a\u0435 \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0445 \u043c\u043e\u0434\u0435\u043b\u0435\u0439 \u0432\u0435\u043b\u043e\u0441\u0438\u043f\u0435\u0434\u043e\u0432 \u044f \u0442\u0430\u043a\u0438 \u0441\u043e\u0431\u0440\u0430\u043b \u0441\u0432\u043e\u0439. \u0411\u0443\u0434\u0435\u0442 \u0445\u043e\u0440\u043e\u0448\u043e, \u0435\u0441\u043b\u0438 \u043f\u043e\u0441\u0442 \u043f\u043e\u043c\u043e\u0436\u0435\u0442 \u0441\u044d\u043a\u043e\u043d\u043e\u043c\u0438\u0442\u044c \u043a\u043e\u043c\u0443-\u0442\u043e \u0432\u0440\u0435\u043c\u044f \u043d\u0430 \u043a\u043e\u043d\u0441\u0442\u0440\u0443\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435.<\/p>\n<p><strong>UPD<\/strong>: \u0421\u0442\u0430\u0442\u044c\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430 \u0438 \u0434\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0430 <strong>2017-02-21<\/strong><\/p>\n<p><!--more--><\/p>\n<h1>\u041e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0439 \u043c\u043e\u0434\u0443\u043b\u044c<\/h1>\n<p>\u0422\u0430\u043a \u043a\u0430\u043a \u044f \u0441\u0442\u043e\u0440\u043e\u043d\u043d\u0438\u043a \u043c\u043e\u0434\u0443\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u043e\u0434\u0445\u043e\u0434\u0430 \u0438 \u0441\u0447\u0438\u0442\u0430\u044e, \u0447\u0442\u043e \u0438\u043c\u0435\u043d\u043d\u043e \u044d\u0442\u043e \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u0441\u043f\u043e\u0441\u043e\u0431 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f <strong>AngualrJS<\/strong>, \u0442\u043e \u0432\u0435\u0441\u044c \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0439 \u0441 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0435\u0439 \u044f \u0441\u043b\u043e\u0436\u0438\u043b \u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0439 \u043c\u043e\u0434\u0443\u043b\u044c <strong>auth<\/strong>. \u041a \u043d\u0435\u043c\u0443 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u044e \u043c\u043e\u0434\u0443\u043b\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f\u00a0<a href=\"https:\/\/docs.angularjs.org\/api\/ngCookies\/service\/$cookies\">\u043a\u0443\u043a\u0438\u0441\u0430\u043c\u0438<\/a> \u0438 \u043c\u043e\u0434\u0443\u043b\u044c \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u0443\u0434\u043e\u0431\u043d\u043e\u0439 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 <strong>REST<\/strong>(<a title=\"github.com\/mgonto\/restangular\" href=\"https:\/\/github.com\/mgonto\/restangular\">restangular<\/a>):<\/p>\n<p>[javascript]angular.module(&#8216;auth&#8217;, [&#8216;ngCookies&#8217;, &#8216;restangular&#8217;]);[\/javascript]<\/p>\n<h2>\u0421\u0435\u0440\u0432\u0438\u0441 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438<\/h2>\n<p>\u041f\u043e\u043d\u044f\u0442\u043d\u043e\u0435 \u0434\u0435\u043b\u043e, \u0447\u0442\u043e \u043a\u0430\u043a\u043e\u0439 \u0431\u044b \u0432\u044b \u0441\u0430\u043c\u043e\u043a\u0430\u0442 \u043d\u0435 \u0434\u0435\u043b\u0430\u043b\u0438, \u0431\u0435\u0437 \u0441\u0435\u0440\u0432\u0438\u0441\u0430 \u043d\u0435 \u043e\u0431\u043e\u0439\u0442\u0438\u0441\u044c. \u0427\u0442\u043e \u0432 \u043d\u0435\u043c \u0434\u043e\u043b\u0436\u043d\u043e \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u044c\u0441\u044f? \u0414\u0435\u043b\u0430\u0435\u043c REST\/token \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u0432 \u0441\u0435\u0440\u0432\u0438\u0441\u0435 \u0431\u0443\u0434\u0435\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b:<\/p>\n<ul>\n<li>\u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u043e \u043b\u043e\u0433\u0438\u043d\u0443 (\u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u0430\u044f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u044f: POST \u0437\u0430\u043f\u0440\u043e\u0441 \u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435\/\u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0442\u043e\u043a\u0435\u043d\u0430)<\/li>\n<li>\u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u043e \u0442\u043e\u043a\u0435\u043d\u0443 (\u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u0430\u044f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u044f: GET \u0437\u0430\u043f\u0440\u043e\u0441 \u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043f\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e)<\/li>\n<li>\u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0441\u0442\u0430\u0442\u0443\u0441\u0430 (\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u0430\u044f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u044f)<\/li>\n<li>\u043b\u043e\u0433\u0430\u0443\u0442 (\u0437\u0430\u0447\u0438\u0441\u0442\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 &#8211; \u0442\u043e\u043a\u0435\u043d\u0430)<\/li>\n<\/ul>\n<p>\u0412\u043e\u0442 \u0443\u043f\u0440\u043e\u0449\u0435\u043d\u043d\u0430\u044f \u0432\u0435\u0440\u0441\u0438\u044f \u043a\u043e\u0434\u0430(\u0432\u044b\u043a\u0438\u043d\u0443\u043b \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0443 \u043e\u0448\u0438\u0431\u043e\u043a):<\/p>\n<p>[javascript]angular.module(&#8216;auth&#8217;)<br \/>\n  .service(&#8216;AuthService&#8217;, function($cookies, $http, Restangular) {<br \/>\n    &#8216;use strict&#8217;;<\/p>\n<p>    var self = this;<br \/>\n    this.status = {<br \/>\n      authorized: false,<br \/>\n    };<\/p>\n<p>    this.loginByCredentials = function(username, password) {<br \/>\n      return Restangular.all(&#8216;sessions&#8217;).post({ email: username, password: password })<br \/>\n        .then(function(response) {<br \/>\n          return self.loginByToken(response.contents);<br \/>\n        });<br \/>\n    };<\/p>\n<p>    this.loginByToken = function(token) {<br \/>\n      $http.defaults.headers.common[&#8216;X-Token&#8217;] = token;<\/p>\n<p>      return Restangular.all(&#8216;sessions&#8217;).get(token)<br \/>\n        .then(function(response) {<br \/>\n          $cookies.accessToken = token;<br \/>\n          self.status.authorized = true;<br \/>\n          return response;<br \/>\n        });<br \/>\n    };<\/p>\n<p>    this.logout = function() {<br \/>\n      self.status.authorized = false;<br \/>\n      $cookies.accessToken = &#8221;;<\/p>\n<p>      Restangular.all(&#8216;sessions&#8217;).remove();<br \/>\n    };<br \/>\n  });[\/javascript]<\/p>\n<p>\u041f\u0440\u0438\u0445\u043e\u0434\u0438\u0442\u0441\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0442\u044c <strong>$http<\/strong> \u0441\u0435\u0440\u0432\u0438\u0441 \u0434\u043b\u044f \u0432\u043e\u0442 \u044d\u0442\u043e\u0433\u043e \u0445\u0430\u043a\u0430:<\/p>\n<p>[javascript]$http.defaults.headers.common[&#8216;X-Token&#8217;] = token;[\/javascript]<\/p>\n<p>&#8211; \u043f\u043e \u0434\u0440\u0443\u0433\u043e\u043c\u0443 \u0432 <strong>Restangular<\/strong> \u043d\u0435 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442\u0441\u044f \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438 \u0437\u0430\u0434\u0430\u0442\u044c \u0445\u0435\u0434\u0435\u0440, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043c\u044b \u0445\u043e\u0442\u0438\u043c \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0442\u043e\u043a\u0435\u043d \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438.<\/p>\n<p>(\u0435\u0441\u043b\u0438 \u0443 \u0432\u0430\u0441 \u0435\u0441\u0442\u044c \u0434\u0440\u0443\u0433\u043e\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u043e\u0439 \u0441\u0438\u0442\u0443\u0430\u0446\u0438\u0438 &#8211; \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u043f\u043e\u0434\u0435\u043b\u0438\u0442\u0435\u0441\u044c)<\/p>\n<h2>\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438<\/h2>\n<p>\u0415\u0441\u043b\u0438 \u0432\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0435 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0439 \u0430\u043d\u0433\u0443\u043b\u044f\u0440\u043e\u0432\u0441\u043a\u0438\u0439 \u0440\u043e\u0443\u0442\u0435\u0440, \u0442\u0443\u0442 \u043c\u043e\u0436\u0435\u0442 \u0432\u043e\u0437\u043d\u0438\u043a\u043d\u0443\u0442\u044c \u0432\u043e\u043f\u0440\u043e\u0441: \u041a\u0430\u043a \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0434\u0440\u0443\u0433\u043e\u0439 \u043b\u044d\u0439\u0430\u0443\u0442?<\/p>\n<p>\u0420\u0435\u0448\u0435\u043d\u0438\u0435 \u043f\u043e\u0434\u0441\u043a\u0430\u0437\u0430\u043b <a title=\"olostan.name\" href=\"http:\/\/olostan.name\/\">\u0412\u0430\u043b\u0435\u043d\u0442\u0438\u043d \u0428\u0438\u0431\u0430\u043d\u043e\u0432<\/a>, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0438\u043b \u0437\u0430\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u0432\u0441\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435(\u0432 \u0442\u043e\u043c \u0447\u0438\u0441\u043b\u0435 <strong>ui-view<\/strong>) \u0432 <strong>ng-if<\/strong>, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0431\u044b \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u0442\u043e\u0433\u043e, \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0438\u0440\u0430\u0432\u0430\u043d \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0438\u043b\u0438 \u043d\u0435\u0442, \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u043b \u0431\u044b \u043b\u0438\u0431\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0435 \u0441 \u043c\u0435\u043d\u044e \u043b\u0438\u0431\u043e \u0444\u043e\u0440\u043c\u043e\u0447\u043a\u0443 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438.<\/p>\n<p>\u0418\u0442\u043e\u0433\u043e \u0438\u043c\u0435\u0435\u043c(\u043e\u043f\u044f\u0442\u044c \u043e\u0447\u0435\u043d\u044c \u0443\u043f\u0440\u043e\u0449\u0435\u043d\u043d\u0430\u044f \u0432\u0435\u0440\u0441\u0438\u044f):<\/p>\n<p>[html]<br \/>\n&lt;div ng-if=&quot;isAutorized&quot;&gt;<br \/>\n    &lt;menu&gt;&lt;\/menu&gt;<br \/>\n    &lt;ui-view&gt;&lt;\/ui-vew&gt;<br \/>\n&lt;div ng-if=&quot;!isAutorized&quot;&gt;<br \/>\n    &lt;login&gt;&lt;\/login&gt;<br \/>\n&lt;\/div&gt;<br \/>\n[\/html]<\/p>\n<h2><\/h2>\n<h2>\u041f\u043b\u044e\u0448\u043a\u0438 \u0441 \u0438\u043d\u0442\u0435\u0440\u0441\u0435\u043f\u0442\u043e\u0440\u0430\u043c\u0438<\/h2>\n<p>\u0415\u0441\u043b\u0438 \u043f\u0435\u0440\u0435\u043e\u0434\u0438\u0447\u0435\u0441\u043a\u0438 \u043f\u0440\u043e\u043f\u0430\u0434\u0430\u0435\u0442 \u0441\u0435\u0441\u0441\u0438\u044f \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c(\u0442\u0430\u0439\u043c\u0430\u0443\u0442), \u043d\u043e \u043a\u043b\u0438\u0435\u043d\u0442 \u043e\u0441\u0442\u0430\u0435\u0442\u0441\u044f \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u043c, \u0438 \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u0435\u0441\u0441\u0438\u044e \u0431\u0435\u0437 \u043f\u0440\u0438\u0432\u043b\u0435\u0447\u0435\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0432 \u0441\u0442\u043e\u0440\u043e\u043d\u0443 <a href=\"https:\/\/stepansuvorov.com\/blog\/2014\/04\/angularjs-interceptors-%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80%D1%8B\/\">\u0438\u043d\u0442\u0435\u0440\u0441\u0435\u043f\u0442\u043e\u0440\u043e\u0432<\/a>. \u0422\u0430\u043a \u0436\u0435 \u0438\u043d\u0442\u0435\u0440\u0441\u0435\u043f\u0442\u043e\u0440\u044b \u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0434\u043b\u044f \u043e\u0431\u0449\u0435\u0439 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u043e\u0448\u0438\u0431\u043e\u043a \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438.<\/p>\n<h2>\u041c\u043e\u043c\u0435\u043d\u0442 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u0438 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u0430<\/h2>\n<p>\u0414\u0430\u0432\u0430\u0439\u0442\u0435 \u0440\u0430\u0437\u0431\u0435\u0440\u0435\u043c\u0441\u044f, \u0432 \u043a\u0430\u043a\u043e\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u043c\u044b \u0434\u043e\u043b\u0436\u043d\u044b\/\u043c\u043e\u0436\u0435\u043c \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0442\u044c \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438. \u0412\u0441\u0435 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u043c\u043e\u0436\u043d\u043e \u0443\u0441\u043b\u043e\u0432\u043d\u043e \u0440\u0430\u0437\u0431\u0438\u0442\u044c \u043d\u0430 2:<\/p>\n<ul>\n<li>\u043e\u0442\u0432\u0435\u0442 API\u00a0(\u043c\u044b \u0443\u0437\u043d\u0430\u043b\u0438 \u043e\u0442 \u0441\u0435\u0440\u0432\u0435\u0440\u0430)<\/li>\n<li>\u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f (\u043f\u0435\u0440\u0435\u0448\u043b\u0438 \u043d\u0430 \u0434\u0440\u0443\u0433\u0443\u044e \u0441\u0442\u0440\u0430\u043d\u0438\u0447\u043a\u0443)\n<ul>\n<li>\u0441\u043e\u0431\u044b\u0442\u0438\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f<\/li>\n<li>\u0440\u0435\u0437\u043e\u043b\u0432 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0441\u0442\u0435\u0439\u0442\u0430<\/li>\n<\/ul>\n<\/li>\n<\/ul>\n<p>\u0414\u0430\u0432\u0430\u0439\u0442\u0435 \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c \u043d\u0430 \u0432\u0441\u0435 \u0441\u043b\u0443\u0447\u0430\u0438.<\/p>\n<h2>\u041e\u0442\u0432\u0435\u0442 \u043e\u0442 API \u0438 \u0438\u043d\u0442\u0435\u0440\u0441\u0435\u043f\u0442\u043e\u0440\u00a0\u0434\u043b\u044f \u043e\u0431\u0440\u0430\u0442\u043a\u0438 \u043e\u0448\u0438\u0431\u043a\u0438<\/h2>\n<p>\u041f\u0440\u043e \u0438\u043d\u0442\u0435\u0440\u0441\u0435\u043f\u0442\u043e\u0440\u044b \u043c\u043e\u0436\u043d\u043e \u0431\u043e\u043b\u0435\u0435 \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u043e \u043f\u043e\u0447\u0438\u0442\u0430\u0442\u044c <a href=\"https:\/\/stepansuvorov.com\/blog\/2014\/04\/angularjs-interceptors-%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80%D1%8B\/\">\u0442\u0443\u0442<\/a>. \u041c\u044b \u0441 \u0432\u0430\u043c\u0438\u00a0\u0440\u0435\u0430\u043b\u0438\u0437\u0443\u0435\u043c \u043e\u0434\u0438\u043d \u0438\u0437 \u043d\u0438\u0445 \u0438\u043d\u0442\u0435\u0441\u0435\u043f\u0442\u043e\u0440 \u043e\u0448\u0438\u0431\u043a\u0438 \u043e\u0442\u0432\u0435\u0442\u0430:<\/p>\n<p>[javascript]<br \/>\napp.service(&#8216;authRejector&#8217;, function($q) {<br \/>\n    this.responseError = (rejection) =&gt; {<br \/>\n      if (rejection.status === 401) {<br \/>\n        \/\/\u0434\u0435\u043b\u0430\u0435\u043c \u043a\u0430\u043a\u0438\u0435-\u0442\u043e \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0431\u0435\u0437 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438<br \/>\n      }<\/p>\n<p>      return $q.reject(rejection);<br \/>\n    };<br \/>\n  });<br \/>\n[\/javascript]<\/p>\n<p>\u0438 \u043f\u043e\u0442\u043e\u043c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c \u043d\u0430\u0448 \u0438\u043d\u0442\u0435\u0440\u0441\u0435\u043f\u0442\u043e\u0440 \u043a \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u043c:<\/p>\n<p>[javascript]<br \/>\n  app.config(function($httpProvider) {<br \/>\n    $httpProvider.interceptors.push(&#8216;authRejector&#8217;);<br \/>\n  });<br \/>\n[\/javascript]<\/p>\n<h2>\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0441\u0442\u0435\u0439\u0442\u0430<\/h2>\n<p>\u041d\u0430\u0432\u0435\u0441\u0438\u0442\u044c \u0445\u0443\u043a \u0432 \u0441\u043e\u0431\u044b\u0442\u0438\u0435 <strong>ui-router<\/strong> \u043c\u043e\u0436\u043d\u043e \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0441\u0435\u0440\u0432\u0438\u0441\u0430 <strong>$transitions<\/strong>:<\/p>\n<p>[javascript]<br \/>\n$transitions.onEnter({ to: &#8216;stateName&#8217; }, function($state$, $transition$) {<br \/>\n  if(!AuthService.status.authorized){<br \/>\n    \/\/\u0434\u0435\u043b\u0430\u0435\u043c \u043a\u0430\u043a\u0438\u0435-\u0442\u043e \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0431\u0435\u0437 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438<br \/>\n    return $q.reject()<br \/>\n  }<\/p>\n<p>}<br \/>\n[\/javascript]<\/p>\n<h2>\u0417\u0430\u043f\u0440\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0440\u0435\u0437\u043e\u043b\u0432<\/h2>\n<p>\u0414\u0430\u0432\u0430\u0439\u0442\u0435 \u043f\u0440\u0435\u0434\u043b\u043e\u043f\u043e\u043b\u0436\u0438\u043c, \u0447\u0442\u043e \u0443 \u043d\u0430\u0441 \u0435\u0441\u0442\u044c \u0441\u0442\u0435\u0439\u0442 <strong>users<\/strong>:<\/p>\n<p>[javascript]<br \/>\n .state(&#8216;users&#8217;, {})<br \/>\n[\/javascript]<\/p>\n<p>\u043a \u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u043c\u044b \u0445\u043e\u0442\u0438\u043c \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f. \u0414\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u0434\u043e\u0431\u0430\u0432\u0438\u043c \u0440\u0435\u0437\u043e\u043b\u0432 \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u0432\u0441\u0435 \u0442\u043e\u0433\u043e \u0436\u0435 \u0441\u0435\u0440\u0432\u0438\u0441\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438:<\/p>\n<p>[javascript]<br \/>\n        .state(&#8216;users&#8217;, {<br \/>\n          resolve: {<br \/>\n            auth: function($q, AuthService) {<br \/>\n              if(!AuthService.status.authorized) {<br \/>\n                $q.reject();<br \/>\n                alert(&#8216;\u0412\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f!&#8217;);<br \/>\n              }<br \/>\n            }<br \/>\n          }<br \/>\n        })<br \/>\n[\/javascript]<\/p>\n<h2>\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u0440\u0438 \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0435 \u043d\u0430 \u0434\u0440\u0443\u0433\u0443\u044e \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443<\/h2>\n<p>\u0412<strong> ui-router<\/strong> \u043c\u044b \u043c\u043e\u0436\u0435\u043c \u043d\u0430\u0432\u0435\u0441\u0438\u0442\u044c \u0445\u0443\u043a \u043d\u0430 \u0441\u043e\u0431\u044b\u0442\u0438\u0435 \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430 \u043d\u0430 \u043a\u0430\u043a\u043e\u0439 \u043b\u0438\u0431\u043e \u0441\u0442\u0435\u0439\u0442 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0441\u0435\u0440\u0432\u0438\u0441\u0430 <strong>$transitions<\/strong>:<\/p>\n<p>[javascript]<br \/>\n$transitions.onEnter({ to: &#8216;stateName&#8217; }, function($state$, $transition$) {<br \/>\n  if(!AuthService.status.authorized){<br \/>\n    \/\/\u0434\u0435\u043b\u0430\u0435\u043c \u043a\u0430\u043a\u0438\u0435-\u0442\u043e \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0431\u0435\u0437 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438<br \/>\n    return $q.reject()<br \/>\n  }<br \/>\n}<br \/>\n[\/javascript]<\/p>\n<p>\u041d\u043e \u0443 \u043f\u0440\u0438\u0432\u0435\u0434\u0435\u043c \u0441\u0430\u043c \u043b\u043e\u0433\u0438\u043d \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442 \u0434\u043b\u044f \u043f\u043e\u043b\u043d\u043e\u0442\u044b \u043f\u0440\u0438\u043c\u0435\u0440\u0430.<\/p>\n<h2>\u041f\u0440\u0438\u043c\u0435\u0440 \u043b\u043e\u0433\u0438\u043d \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430<\/h2>\n<p>[javascript]<br \/>\napp.component(&#8216;login&#8217;, {<br \/>\n  controller: function(AuthService){<br \/>\n    this.login = function(login, password)<br \/>\n    AuthService.loginByCredentials(login, password).catch(function(){<br \/>\n      \/\/\u0432\u044b\u0432\u043e\u0434\u0438\u043c \u043e\u0448\u0438\u0431\u043a\u0443 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438<br \/>\n    });<br \/>\n  }<br \/>\n});<br \/>\n[\/javascript]<\/p>\n<p>&nbsp;<\/p>\n","protected":false},"excerpt":{"rendered":"<p>\u0418\u0437\u0443\u0447\u0438\u0432 \u043a\u0443\u0447\u0443 \u0438\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u0439 \u043f\u043e \u0441\u0431\u043e\u0440\u043a\u0435 \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0445 \u043c\u043e\u0434\u0435\u043b\u0435\u0439 \u0432\u0435\u043b\u043e\u0441\u0438\u043f\u0435\u0434\u043e\u0432 \u044f \u0442\u0430\u043a\u0438 \u0441\u043e\u0431\u0440\u0430\u043b \u0441\u0432\u043e\u0439. \u0411\u0443\u0434\u0435\u0442 \u0445\u043e\u0440\u043e\u0448\u043e, \u0435\u0441\u043b\u0438 \u043f\u043e\u0441\u0442 \u043f\u043e\u043c\u043e\u0436\u0435\u0442 \u0441\u044d\u043a\u043e\u043d\u043e\u043c\u0438\u0442\u044c \u043a\u043e\u043c\u0443-\u0442\u043e \u0432\u0440\u0435\u043c\u044f \u043d\u0430 \u043a\u043e\u043d\u0441\u0442\u0440\u0443\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435. UPD: \u0421\u0442\u0430\u0442\u044c\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430 \u0438 \u0434\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0430 2017-02-21<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[4],"tags":[120,48,17,369],"_links":{"self":[{"href":"https:\/\/stepansuvorov.com\/blog\/wp-json\/wp\/v2\/posts\/1622"}],"collection":[{"href":"https:\/\/stepansuvorov.com\/blog\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/stepansuvorov.com\/blog\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/stepansuvorov.com\/blog\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/stepansuvorov.com\/blog\/wp-json\/wp\/v2\/comments?post=1622"}],"version-history":[{"count":17,"href":"https:\/\/stepansuvorov.com\/blog\/wp-json\/wp\/v2\/posts\/1622\/revisions"}],"predecessor-version":[{"id":3281,"href":"https:\/\/stepansuvorov.com\/blog\/wp-json\/wp\/v2\/posts\/1622\/revisions\/3281"}],"wp:attachment":[{"href":"https:\/\/stepansuvorov.com\/blog\/wp-json\/wp\/v2\/media?parent=1622"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/stepansuvorov.com\/blog\/wp-json\/wp\/v2\/categories?post=1622"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/stepansuvorov.com\/blog\/wp-json\/wp\/v2\/tags?post=1622"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}